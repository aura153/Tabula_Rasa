<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOME GPT (Optimized: Hybrid MR Loading)</title>
    
    <style>
        /* * [ê³µí†µ Â· ë ˆì´ì•„ì›ƒ ì„¤ëª…]
         * - ì´ ìŠ¤íƒ€ì¼ ì‹œíŠ¸ëŠ” HOME GPT ë ˆì´ì•„ì›ƒì— ëŒ€í•œ ê¸°ë³¸ ìŠ¤íƒ€ì¼ì´ë©°,
         * ê´‘ê³ ì™€ ì§ì ‘ì ìœ¼ë¡œ ì—°ê´€ëœ CSS(.ad-slot, .mk-ad-label ë“±)ì— ì£¼ì„ì„ íŠ¹íˆ ê°•í™”í•˜ì˜€ìŠµë‹ˆë‹¤.
         */

        body { font-family: 'Malgun Gothic', 'Dotum', Arial, sans-serif; margin: 0; padding: 0; background-color: #f6f6f6; color: #333; }
        a { text-decoration: none; color: inherit; }

        /* [ë³€ê²½ Â· ì»¨í…Œì´ë„ˆ í­ ì •ì±…] max-width: 1246px */
        .container { max-width: 1246px; margin: 0 auto; padding: 0 10px; }

        header { width: 100%; background-color: #fff; border-bottom: 1px solid #ddd; padding: 10px 0; text-align: center; }
        .logo { font-size: 28px; font-weight: bold; color: #000; }
        nav { background-color: #f9f9f9; border-bottom: 2px solid #333; margin-bottom: 20px; }
        .nav-list { list-style: none; padding: 0; margin: 0; display: flex; justify-content: flex-start; }
        .nav-list li { padding: 10px 15px; font-weight: bold; border-right: 1px solid #eee; }
        .nav-list li:first-child { color: #c00; }

        .content-wrap { display: flex; gap: 20px; margin-bottom: 30px; }

        /*
         * [ë ˆì´ì•„ì›ƒ Â· ë©”ì¸/ìš°ì¸¡ ì»¬ëŸ¼ ë¹„ìœ¨ ì „ëµ]
         * - ë°ìŠ¤í¬íƒ‘: ì‚¬ì´ë“œë°” 336px ê³ ì •
         * - ëª¨ë°”ì¼: ì‚¬ì´ë“œë°” í­ 100%
         */
        .main-content {
            flex: 1 1 auto;  /* ë‚¨ì€ ê³µê°„ì„ ìœ ì—°í•˜ê²Œ ì°¨ì§€ */
            min-width: 0;
        }

        .sidebar {
            background-color: #fff;
            padding: 0;                 /* ì™¸ê³½ ì»¨í…Œì´ë„ˆ padding 0 ìœ ì§€ */
            box-sizing: border-box;
            border-radius: 5px;
        }
        
        /* [ê´‘ê³  ê³µí†µ Â· .ad-slot ë˜í¼ ì„¤ëª…] */
        .ad-slot {
            position: relative;
            text-align: center;
            display: flex;              /* View GPTì™€ ë™ì¼: flex ì»¨í…Œì´ë„ˆ */
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            font-size: 14px;
            font-weight: bold;
            box-sizing: border-box;
            border: none;
            padding: 10px 0 0 0;        /* ìƒë‹¨ ì—¬ë°± 10px (ë¼ë²¨ ê³µê°„ í™•ë³´) */
            background-color: transparent;
            width: 100%;                /* ë¶€ëª¨ ì»¨í…Œì´ë„ˆ í­ 100% ì‚¬ìš© */
            height: auto;               /* ë†’ì´ëŠ” ì‹¤ì œ ê´‘ê³  í¬ë¦¬ì—ì´í‹°ë¸Œì— ì˜í•´ ê²°ì • */
            line-height: 1.5;
            overflow: visible;
            color: transparent;         /* í…ìŠ¤íŠ¸ ì»¬ëŸ¬ëŠ” íˆ¬ëª… ì²˜ë¦¬ */
            z-index: 10;
        }

        /* [ê´‘ê³  ê³µí†µ Â· .gam-container ì„¤ëª…] */
        .gam-container {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-grow: 1;
            min-height: 0;
        }
        
        /* [ê´‘ê³  ê°œë³„ ID ìŠ¤íƒ€ì¼] */
        #TC_billboard_leaderboard, #MC_billboard_rectangle, #MR_halfpage_rectangle { 
            background-color: transparent !important; 
            border: none !important; 
        }

        /* [ë””ë²„ê·¸ Â· .ad-loaded ì„¤ëª…] */
        .ad-loaded { background-color: #c00 !important; color: #fff; }
        
        /* [ê³µí†µ Â· mk-ad-label (Advertisement ë¼ë²¨) ì„¤ëª…] */
        .mk-ad-label {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            padding: 0;
            background-color: transparent;
            border: none;
            color: #5A5A5A;
            font-size: 13px;        /* View GPTì™€ í†µì¼: 13px */
            font-weight: normal;    /* ë³¼ë“œ í•´ì œ */
            text-transform: uppercase;
            line-height: 1;
            white-space: nowrap;
        }

        /* [TC ì „ìš© Â· ìƒë‹¨ ë‹«ê¸° ë²„íŠ¼ UI] */
        .mk-ad-close-button {
            position: absolute;
            top: 20px;
            right: 10px;
            padding: 4px 4px;
            border-radius: 2px;
            background-color: rgba(0, 0, 0, 0.35);
            display: inline-flex;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            z-index: 200;
            white-space: nowrap;
            box-shadow: none;
            border: none;               
        }

        .mk-ad-close-button input[type="checkbox"] {
            width: 14px;
            height: 14px;
            margin: 0 2px 0 0;
            padding: 0;
        }

        .mk-ad-close-button,
        .mk-ad-close-label,
        .mk-ad-close-text,
        .mk-ad-close-separator {
            font-size: 14px;
            font-weight: 500;
            color: #ffffff;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.35), 0 3px 6px rgba(0, 0, 0, 0.25);
        }

        .mk-ad-close-label,
        .mk-ad-close-text,
        .mk-ad-close-separator {
            display: inline-block;
            line-height: 1;
        }

        .mk-ad-close-separator {
            opacity: 0.85;
        }
        
        @media (prefers-color-scheme: dark) {
            body { background-color: #1a1a1a; color: #e0e0e0; }
            header { background-color: #1a1a1a; border-bottom-color: #444; }
            .logo { color: #fff; } 
            nav { background-color: #1a1a1a; border-bottom: 2px solid #666; }

            .sidebar { background-color: #1a1a1a; border-color: #444; }
            .sidebar-item { background-color: #1a1a1a; border-color: #444; }

            .mk-ad-label {
                background-color: transparent;
                color: #A0A0A0;
                border: none;
            }
        }

        /* ë°ìŠ¤í¬íƒ‘ ë ˆì´ì•„ì›ƒ (>= 1025px) */
        @media (min-width: 1025px) {
            .sidebar {
                flex: 0 0 336px;   /* ì „ì²´ ì»¨í…Œì´ë„ˆ í­ 336px */
                min-width: 336px;  /* ìµœì†Œ í­ ë³´ì¥ */
                max-width: 336px;  /* ìµœëŒ€ í­ë„ 336pxë¡œ ê³ ì • */
            }
        }

        /* ëª¨ë°”ì¼ ë ˆì´ì•„ì›ƒ (<= 1024px) */
        @media (max-width: 1024px) {
            .content-wrap { flex-direction: column; }

            .sidebar {
                width: 100%;
                flex: 1 1 auto;
                min-width: 0;
            }
        }
    </style>
    
    <script async src='https://www.googletagservices.com/tag/js/gpt.js'></script>
    <script>
        /*
         * [ê³µí†µ Â· googletag ì „ì—­ ë„¤ì„ìŠ¤í˜ì´ìŠ¤]
         */
        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];

        /*
         * [ê³µí†µ Â· ë‹¤í¬ ëª¨ë“œ í”Œë˜ê·¸ isDarkMode]
         */
        const isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'true' : 'false';

        /*
         * [ê³µí†µ Â· AdUnitPath ì„¤ëª…]
         */
        const AdUnitPath = '/7450/www.mk.co.kr/HOME';

        // ğŸ’¡ ìŠ¬ë¡¯ ê°ì²´ ì €ì¥
        let TC_billboard_leaderboard_slot = null;
        let MC_billboard_rectangle_slot   = null;
        let MR_halfpage_rectangle_slot    = null;

        // ***************************************************
        // âœ… 'ì˜¤ëŠ˜ í•˜ë£¨ ë‹«ê¸°' / ë””ë°”ì´ìŠ¤ ì •ì±… ê´€ë ¨ ì „ì—­ í—¬í¼ë“¤
        // ***************************************************

        // ë‚ ì§œë³„ í‚¤: 'MK_TC_BILLBOARD_CLOSED_YYYYMMDD'
        function getTodayKeyForTc() {
            const now = new Date();
            const yyyy = now.getFullYear();
            const mm = String(now.getMonth() + 1).padStart(2, '0');
            const dd = String(now.getDate()).padStart(2, '0');
            return 'MK_TC_BILLBOARD_CLOSED_' + yyyy + mm + dd;
        }

        function isTcBillboardCloseFeatureEnabled() {
            const device = window.__MK_DEVICE_CATEGORY__ || 'desktop';
            if (window.__MK_TC_CLOSE_ENABLED__ === false) {
                return false;
            }
            // ë°ìŠ¤í¬íƒ‘ì—ì„œë§Œ ë‹«ê¸° ê¸°ëŠ¥ ì œê³µ
            return device === 'desktop';
        }

        function isTcBillboardSuppressedForToday() {
            if (!isTcBillboardCloseFeatureEnabled()) return false;
            try {
                if (!window.localStorage) return false;
                const key = getTodayKeyForTc();
                return window.localStorage.getItem(key) === '1';
            } catch (e) {
                console.log('âš ï¸ [TC Close] localStorage not available, suppression disabled.', e);
                return false;
            }
        }

        function markTcBillboardClosedForToday() {
            if (!isTcBillboardCloseFeatureEnabled()) return;
            try {
                if (!window.localStorage) return;
                const key = getTodayKeyForTc();
                window.localStorage.setItem(key, '1');
                console.log(`âœ… [TC Close] Marked closed for today. key=${key}`);
            } catch (e) {
                console.log('âš ï¸ [TC Close] Failed to write localStorage.', e);
            }
        }

        function addCloseButtonForSlot(outerSlot) {
            if (!outerSlot) return;
            if (outerSlot.querySelector('.mk-ad-close-button')) return;

            const closeBtn = document.createElement('button');
            closeBtn.type = 'button';
            closeBtn.className = 'mk-ad-close-button';

            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';

            const labelSpan = document.createElement('span');
            labelSpan.className = 'mk-ad-close-label';
            labelSpan.textContent = 'ì˜¤ëŠ˜í•˜ë£¨';

            const sepSpan = document.createElement('span');
            sepSpan.className = 'mk-ad-close-separator';
            sepSpan.textContent = '|';

            const closeTextSpan = document.createElement('span');
            closeTextSpan.className = 'mk-ad-close-text';
            closeTextSpan.textContent = 'ë‹«ê¸° X';

            labelSpan.addEventListener('click', function (e) {
                e.stopPropagation();
                checkbox.checked = !checkbox.checked;
            });

            closeBtn.addEventListener('click', function () {
                if (checkbox.checked) {
                    markTcBillboardClosedForToday();
                }
                outerSlot.style.display = 'none';
                console.log(`ğŸ§¹ [TC Close] TC_billboard_leaderboard hidden (checkbox=${checkbox.checked})`);
            });

            closeBtn.appendChild(checkbox);
            closeBtn.appendChild(labelSpan);
            closeBtn.appendChild(sepSpan);
            closeBtn.appendChild(closeTextSpan);

            outerSlot.appendChild(closeBtn);
        }

        // ***************************************************
        // âœ… ê´‘ê³  ë Œë”ë§ ì™„ë£Œ ì‹œ 'Advertisement' ë¼ë²¨ ë° TC ì „ìš© ì²˜ë¦¬ í•¨ìˆ˜
        // ***************************************************
        function addAdLabel(event) {
            const slotId = event.slot.getSlotElementId();
            const slotElement = document.getElementById(slotId);
            if (!slotElement) return;

            const outerSlot = slotElement.closest('.ad-slot') || slotElement;

            // ğŸ’¡ [TC ì „ìš© ë¶„ê¸°] ìƒë‹¨ ë¹Œë³´ë“œ (HOME ì´ˆê¸°ë©´)
            if (slotId === 'TC_billboard_leaderboard') {
                if (event.isEmpty) return;

                if (isTcBillboardCloseFeatureEnabled()) {
                    addCloseButtonForSlot(outerSlot);
                } else {
                    console.log('[TC Close] Feature disabled (device != desktop or global flag false).');
                }
                return; // TCëŠ” ë¼ë²¨ ë¯¸ë¶€ì°©
            }

            // ğŸ’¡ [ì¼ë°˜ ìŠ¬ë¡¯] 'Advertisement' ë¼ë²¨ ìë™ ì‚½ì…
            if (event.isEmpty === false && outerSlot) {
                if (outerSlot.querySelector('.mk-ad-label')) return;

                const labelElement = document.createElement('div');
                labelElement.className = 'mk-ad-label';
                labelElement.textContent = 'Advertisement';

                outerSlot.insertBefore(labelElement, outerSlot.firstChild);

                outerSlot.style.border = 'none';
                outerSlot.style.backgroundColor = 'transparent';

                console.log(`âœ… [Ad Label] Label added for ${slotId}`);
            }
        }
        // ***************************************************

        googletag.cmd.push(function() {
            
            // --- [1] device_category ê²°ì • -----------------
            const userAgent = navigator.userAgent.toLowerCase();
            const width = window.innerWidth;
            let deviceCategory = 'desktop';

            if ((/mobile|android|iphone|ipod/.test(userAgent) && !/ipad/.test(userAgent)) || width <= 768) {
                deviceCategory = 'smartphone';
            } else if (/ipad|tablet/.test(userAgent) || width <= 1024) {
                deviceCategory = 'tablet';
            }

            googletag.pubads().setTargeting('device_category', deviceCategory);
            window.__MK_DEVICE_CATEGORY__ = deviceCategory;
            
            // --- [2] í˜ì´ì§€ ë ˆë²¨ í‚¤/ê°’ ì„¤ì • ---
            googletag.pubads().setTargeting('domain', window.location.hostname);
            googletag.pubads().setTargeting('url', window.location.href);
            googletag.pubads().setTargeting('referer', document.referrer);
            googletag.pubads().setTargeting('is_dark_mode', isDarkMode);
            googletag.pubads().setTargeting('gpt_version', '2025'); 

            googletag.pubads().setTargeting('web_type', 'responsive');
            googletag.pubads().setTargeting('page_type', 'HOME');
            googletag.pubads().setTargeting('section_home_nm', 'MK');
            
            // â–¼â–¼â–¼ ë™ì  ì…ë ¥ í‚¤-ê°’ â–¼â–¼â–¼
            googletag.pubads().setTargeting('section_front_nm', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('section_list_nm', 'ë™ì ì…ë ¥');
            // ... (ê¸°íƒ€ ë™ì  í‚¤ê°’ ìƒëµ ì—†ì´ ìœ ì§€)
            googletag.pubads().setTargeting('SOURCE_ID', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('source_type', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('MIDDLE_CODE_ENG_NM', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('CODE_ID', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('article_num', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('title', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('title_slug', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('url_slug', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('publish_date', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('journalist', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('keywords', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('ticker_name', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('has_video', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('is_app_viewer', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('login_type', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('login_status', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('membership_type', 'ë™ì ì…ë ¥');
            googletag.pubads().setTargeting('brandsensitive', 'ë™ì ì…ë ¥');
            // â–²â–²â–² ë™ì  ì…ë ¥ í‚¤-ê°’ â–²â–²â–²

            // --- [3] GPT í•µì‹¬ ê¸°ëŠ¥ ì„¤ì • ---
            googletag.pubads().enableSingleRequest();
            googletag.pubads().setPublisherProvidedId('PPID_DYNAMIC_HASHED_ID (SERVER_HASHED_ID)');

            googletag.setConfig({
                // 1. Single Request Architecture í™œì„±í™”
                singleRequest: true, 
                
                // 2. ì´ˆê¸° ë¡œë”© ë°©ì§€ (Lazy Load í•„ìˆ˜)
                disableInitialLoad: true,
                
                // 3. ê´‘ê³  iframe ì¤‘ì•™ ì •ë ¬
                centering: true,
                
                // 4. ê´‘ê³  ìš”ì²­ ì „ ë¹ˆ ìŠ¬ë¡¯ ì ‘ê¸°
                collapseDiv: 'BEFORE_FETCH'
            });
            
            // âœ… GAM ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            googletag.pubads().addEventListener('slotRenderEnded', addAdLabel);

            // --- [4] Size Mapping ì •ì˜ ---

            // 0-1. ê°€ë¡œí˜• ë°°ë„ˆìš© ì‚¬ì´ì¦ˆ ë§¤í•‘ (TC, MC)
            const sizeMapping_horizontal = googletag.sizeMapping()
                .addSize([1024, 0], [
                    [1246, 100], [1200, 300], [1200, 100], 
                    [980, 120], [970, 250], [930, 180], [970, 90], 
                    [728, 90], 
                    [2, 1], [1, 1], 'fluid'
                ])
                .addSize([768, 0], [
                    [750, 300], [750, 200], [728, 90], 
                    [480, 320], 
                    [336, 280], [320, 480], [300, 250], 
                    [2, 1], [1, 1], 'fluid'
                ])
                .addSize([0, 0], [
                    [336, 280], [320, 480],
                    [320, 100], [320, 50], 
                    [300, 250], [250, 250], [200, 200], 
                    [2, 1], [1, 1], 'fluid'
                ])
                .build();

            // 0-2. ìš°ì¸¡ ì‚¬ì´ë“œë ˆì¼ ë°•ìŠ¤í˜• ë°°ë„ˆìš© ì‚¬ì´ì¦ˆ ë§¤í•‘ (MR)
            const sizeMapping_siderail_square = googletag.sizeMapping()
                .addSize([1024, 0], [
                    [336, 280], [320, 480], [300, 600], 
                    [300, 250], [250, 250], [200, 200], 
                    [2, 1], [1, 1], 'fluid'
                ])
                .addSize([768, 0], [
                    [750, 300], [750, 200], [728, 90], 
                    [480, 320], 
                    [336, 280],[320, 480],
                    [300, 250], [250, 250], [200, 200],
                    [2, 1], [1, 1], 'fluid'
                ])
                .addSize([0, 0], [
                    [336, 280], [320, 480],
                    [300, 250], [250, 250], [200, 200],
                    [2, 1], [1, 1], 'fluid'
                ])
                .build();

            // 2. ê´‘ê³  ìŠ¬ë¡¯ ì •ì˜ 

            // TC_billboard_leaderboard (Eager Load)
            TC_billboard_leaderboard_slot = googletag.defineSlot(
                AdUnitPath,
                [
                    [1246, 100], [1200, 300], [1200, 100], 
                    [980, 120], [970, 250], [930, 180], [970, 90], 
                    [728, 90], 
                    [320, 100], [320, 50], 
                    [2, 1], [1, 1], 'fluid'
                ],
                'TC_billboard_leaderboard'
            )
                .defineSizeMapping(sizeMapping_horizontal) 
                .setTargeting('div_id', 'TC_billboard_leaderboard')
                .setTargeting('load_type', 'eager')           // í˜ì´ì§€ ì§„ì… ì¦‰ì‹œ ë…¸ì¶œ
                .setTargeting('position', 'TC')
                .setTargeting('ad_area_type', 'ATF')
                .setTargeting('default_exposure', 'hidden')
                .addService(googletag.pubads());

            // MC_billboard_rectangle (Lazy Load)
            MC_billboard_rectangle_slot = googletag.defineSlot(
                AdUnitPath,
                [
                    [1246, 100], [1200, 300], [1200, 100], 
                    [980, 120], [970, 250], [970, 90], [930, 180], 
                    [750, 300], [750, 200], [728, 90], 
                    [480, 320], [336, 280], [320, 480], 
                    [300, 250], [250, 250], [200, 200], 
                    [2, 1], [1, 1], 'fluid'
                ],
                'MC_billboard_rectangle'
            )
                .defineSizeMapping(sizeMapping_horizontal) 
                .setTargeting('div_id', 'MC_billboard_rectangle')
                .setTargeting('load_type', 'lazy')
                .setTargeting('position', 'MC')
                .setTargeting('ad_area_type', '')
                .setTargeting('default_exposure', '') 
                .addService(googletag.pubads());

            // MR_halfpage_rectangle (Hybrid Load)
            // ğŸ’¡ [ìˆ˜ì • ì‘ì—… 1] ë°ìŠ¤í¬í†±ì¼ ë•ŒëŠ” eager, ê·¸ ì™¸(ëª¨ë°”ì¼/íƒœë¸”ë¦¿)ëŠ” lazyë¡œ ë¶„ê¸°
            MR_halfpage_rectangle_slot = googletag.defineSlot(
                AdUnitPath,
                [
                    [750, 300], [750, 200], [728, 90], 
                    [480, 320], [336, 280], [320, 480], 
                    [300, 600], [300, 250], 
                    [250, 250], [200, 200], 
                    [2, 1], [1, 1], 'fluid'
                ],
                'MR_halfpage_rectangle'
            )
                .defineSizeMapping(sizeMapping_siderail_square) 
                .setTargeting('div_id', 'MR_halfpage_rectangle')
                // ğŸ’¡ load_type ë¶„ê¸° ì²˜ë¦¬: desktop -> eager, others -> lazy
                .setTargeting('load_type', deviceCategory === 'desktop' ? 'eager' : 'lazy')
                .setTargeting('position', 'MR')
                .setTargeting('ad_area_type', '')
                .setTargeting('default_exposure', '')
                .addService(googletag.pubads());
            
            googletag.enableServices();

            /*
             * [Eager Load ì‹¤í–‰ - í˜ì´ì§€ ë¡œë”© ì¦‰ì‹œ í˜¸ì¶œ]
             * ğŸ’¡ [ìˆ˜ì • ì™„ë£Œ] Section GPTì™€ ë™ì¼í•˜ê²Œ, Headì—ì„œ Eager ìŠ¬ë¡¯ì„ ì¼ê´„ í˜¸ì¶œí•©ë‹ˆë‹¤.
             * 1. TC (í•­ìƒ Eager)
             * 2. MR (ë°ìŠ¤í¬íƒ‘ì¼ ë•Œ Eager)
             */
            googletag.cmd.push(function () {
                // TC ë‹«ê¸° ì •ì±… í™•ì¸ (Suppression)
                if (typeof isTcBillboardSuppressedForToday === 'function' &&
                    isTcBillboardSuppressedForToday()) {
                    console.log('â¸ [TC Close] Suppressed for today. Skip TC REFRESH.');
                    // TC ìˆ¨ê¹€ ì²˜ë¦¬ ë“±ì€ DOMì´ ì•„ì§ ì—†ìœ¼ë¯€ë¡œ bodyì—ì„œ ì²˜ë¦¬ë˜ê±°ë‚˜ CSSë¡œ ì œì–´ ê¶Œì¥
                    // ì—¬ê¸°ì„œëŠ” refresh ë¦¬ìŠ¤íŠ¸ì—ì„œë§Œ ì œì™¸
                }

                var eagerSlotsToRefresh = [];

                // 1. TC (í•­ìƒ Eager + ë‹«ê¸° ì •ì±… í†µê³¼ ì‹œ)
                // ë§Œì•½ ë‹«í˜ ìƒíƒœë¼ë©´ isTcBillboardSuppressedForToday()ê°€ trueì¼ ê²ƒì´ë¯€ë¡œ
                // ìœ„ì—ì„œ return ì‹œí‚¤ê±°ë‚˜ ì—¬ê¸°ì„œ ì²´í¬í•´ì•¼ í•¨.
                // ì—¬ê¸°ì„œëŠ” ì•ˆì „í•˜ê²Œ ì²´í¬ í›„ ì¶”ê°€
                const isTcSuppressed = (typeof isTcBillboardSuppressedForToday === 'function' && isTcBillboardSuppressedForToday());
                
                if (TC_billboard_leaderboard_slot && !isTcSuppressed) {
                    googletag.display('TC_billboard_leaderboard');
                    eagerSlotsToRefresh.push(TC_billboard_leaderboard_slot);
                } else if (isTcSuppressed) {
                    // ë‹«íŒ ìƒíƒœë¼ë©´ display í˜¸ì¶œ ì•ˆí•¨
                }

                // 2. MR (ë°ìŠ¤í¬íƒ‘ì¼ ë•Œë§Œ Eager)
                if (deviceCategory === 'desktop' && MR_halfpage_rectangle_slot) {
                    googletag.display('MR_halfpage_rectangle');
                    eagerSlotsToRefresh.push(MR_halfpage_rectangle_slot);
                }

                // ì¼ê´„ Refresh í˜¸ì¶œ
                if (eagerSlotsToRefresh.length > 0) {
                    googletag.pubads().refresh(eagerSlotsToRefresh);
                    console.log('âš¡ [Head Eager Load] Immediately refreshed slots:', eagerSlotsToRefresh.map(s => s.getSlotElementId()));
                }
            });
        });
    </script>
</head>
<body>

    <header>
        <div class="container">
            <div class="logo">HOME GPT</div>
        </div>
    </header>

    <nav>
        <div class="container">
            <ul class="nav-list">
                <li>HOME</li>
                <li>ë‰´ìŠ¤ì¢…í•©</li>
                <li>ë¶€ë™ì‚°</li>
                <li>ì¦ê¶Œ</li>
                <li>ì˜¤í”¼ë‹ˆì–¸</li>
                <li>ìŠ¤í¬ì¸ </li>
            </ul>
        </div>
    </nav>
    
    <div class="container">
        <div id="TC_billboard_leaderboard" class="ad-slot ad-1 gam-container">
            <div class="gam-container"></div>
        </div>

        <div class="content-wrap">
            <div class="main-content">
                <section class="highlight-news">
                    <h2>ğŸ”¥ Main Contents: Highlight News</h2>
                    <p style="font-size: 20px; font-weight: bold; margin-bottom: 5px;">**ç¾ ë¹…í…Œí¬, AI ì£¼ë„ê¶Œ ê²½ìŸ ì‹¬í™”... íˆ¬ì ê¸‰ì¦ ì† ê·œì œ ë¦¬ìŠ¤í¬ ë¶€ìƒ**</p>
                    <p style="font-size: 14px; color: #555;">* AI ë°˜ë„ì²´ ìˆ˜ê¸‰ë‚œ ì¥ê¸°í™”... K-ë°˜ë„ì²´ ì—…ê³„ ìƒˆë¡œìš´ ì „ëµ ëª¨ìƒ‰</p>
                    <ul style="list-style: disc; padding-left: 20px; margin-top: 5px; color: #007bff;">
                        <li>ì°¨ì„¸ëŒ€ LLM ëª¨ë¸ ê³µê°œ, ì´ˆê±°ëŒ€ AI ê²½ìŸì˜ ì„œë§‰</li>
                        <li>ìƒì„±í˜• AIì˜ í™•ì‚°, ì½˜í…ì¸  ì‚°ì—…ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ë¶„ì„</li>
                    </ul>
                </section>
                <section class="article-section">
                    <h2>ğŸ’° Main Contents: Market & Finance</h2>
                    <p style="font-size: 20px; font-weight: bold; margin-bottom: 5px;">**ê¸ˆë¦¬ ì¸í•˜ ê¸°ëŒ€ê° 'ì£¼ì¶¤'... ì½”ìŠ¤í”¼ 2700ì„  ê³µë°© ì¥ê¸°í™” ì˜ˆìƒ**</p>
                    <p style="font-size: 14px; color: #555;">* ë¶€ë™ì‚° PF ë¦¬ìŠ¤í¬ ì¬ë¶€ê°, ê¸ˆìœµë‹¹êµ­ 'ì„ ì œì  ëŒ€ì‘' ì£¼ë¬¸</p>
                    <div class="news-item">
                        <div class="news-item-img"></div>
                        <p style="margin: 0; font-weight: bold;">[ì†ë³´] ì›/ë‹¬ëŸ¬ í™˜ìœ¨, ì¥ì¤‘ 1,350ì› ëŒíŒŒ... ìˆ˜ì¶œ ê¸°ì—… í¬ë¹„ êµì°¨</p>
                    </div>
                </section>
                <div class="spacer-section">
                    <h3>ğŸ’¡ Special Feature: Future Tech</h3>
                    <p style="font-size: 16px;">**ìš°ì£¼ ê²½ì œ ì‹œëŒ€ ê°œë§‰: ë¯¼ê°„ ìš°ì£¼ì„ , ì €ê¶¤ë„ í†µì‹ ë§ ê²½ìŸ ê°€ì—´**</p>
                    <ul style="list-style: square; padding-left: 20px; margin-top: 5px;">
                        <li>ì°¨ì„¸ëŒ€ LLM ëª¨ë¸ ê³µê°œ, ì´ˆê±°ëŒ€ AI ê²½ìŸì˜ ì„œë§‰</li>
                        <li>ì–‘ì ì»´í“¨í„° ìƒìš©í™”, ë³´ì•ˆ íŒ¨ëŸ¬ë‹¤ì„ ë³€í™” ì˜ˆê³ </li>
                    </ul>
                </div>
            </div>
            
            <div class="sidebar">
                <h3>â­ Right Contents: Popular Ranking</h3>
                <ul class="ranking-list">
                    <li>1. [ë‹¨ë…] 2026ë…„ ê°€ê³„ë¶€ì±„ ì „ë§ ë³´ê³ ì„œ...</li>
                    <li>2. í…ŒìŠ¬ë¼ ë‹¤ìŒì€ ì´ ê¸°ì—…? ë¡œë´‡ì£¼ ì£¼ëª©</li>
                    <li>3. ìƒë°˜ê¸° ìµœê³  ìˆ˜ìµë¥  í€ë“œ ë¦¬ìŠ¤íŠ¸ ê³µê°œ</li>
                </ul>
                <div class="sidebar-item">
                    <h4>Quick Stats</h4>
                    <p>ì½”ìŠ¤í”¼: +0.5% | ë‚˜ìŠ¤ë‹¥: -0.2%</p>
                </div>
                <div class="sidebar-item">
                    <h4>Editorial Picks</h4>
                    <p>ë…¼ì„¤: "AI ìœ¤ë¦¬, ê¸°ì—…ì˜ ì‚¬íšŒì  ì±…ì„ìœ¼ë¡œ"</p>
                </div>
            </div>
        </div>
        
        <div id="MC_billboard_rectangle" class="ad-slot ad-2">
            <div class="gam-container">
                </div>
        </div>

        <div class="content-wrap">
            <div class="main-content">
                <section class="article-section">
                    <h2>ğŸŒ Sub Contents: Global Issue</h2>
                    <p style="font-size: 20px; font-weight: bold; margin-bottom: 5px;">**ìœ ëŸ½, ë…¹ìƒ‰ ì „í™˜ ê°€ì†... íƒ„ì†Œ êµ­ê²½ì„¸ ë„ì… í˜„ì‹¤í™”**</p>
                    <div class="news-item">
                        <div class="news-item-img"></div>
                        <p style="margin: 0; font-weight: bold;">ëŸ¬ì‹œì•„-ìš°í¬ë¼ì´ë‚˜ ì „ìŸ ì¥ê¸°í™”, êµ­ì œ ì—ë„ˆì§€ ì‹œì¥ ë¶ˆì•ˆì • ì‹¬í™”</p>
                    </div>
                </section>
                <div class="spacer-section">
                    <h3>ğŸ­ Sub Contents: Society & Culture</h3>
                    <p style="font-size: 16px;">**OTT êµ¬ë…ë£Œ ì¸ìƒ ë„ë¯¸ë…¸... ì†Œë¹„ì ë¶€ë‹´ ì¦ê°€ ë…¼ë€**</p>
                    <ul style="list-style: circle; padding-left: 20px; margin-top: 5px;">
                        <li>MZì„¸ëŒ€ 'ê°“ìƒ' íŠ¸ë Œë“œ ì† ìˆ¨ê²¨ì§„ ì˜ë¯¸</li>
                    </ul>
                </div>
                <div class="spacer-section" style="border-left-color: #38761d;">
                    <h3>ğŸ“ Policy Briefing</h3>
                    <p style="font-size: 16px;">**ì •ë¶€, ì €ì¶œì‚° ëŒ€ì±… ë°œí‘œ... íŒŒê²©ì ì¸ ì£¼ê±° ì§€ì› ë°©ì•ˆ í¬í•¨**</p>
                </div>
            </div>
            
            <div class="sidebar">
                <h3>ğŸ“Œ Right Contents: Investment Tips</h3>
                <ul class="ranking-list" style="counter-reset: none; padding-left: 10px; list-style-type: disc;">
                    <li>ì¸í”Œë ˆì´ì…˜ í—¤ì§€ í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì¶• ì „ëµ</li>
                </ul>
                <h3 style="margin-top: 20px;">ğŸ“Œ Right Contents: Tech Review</h3>
                <div class="sidebar-item">
                    <p>ìµœì‹  ìŠ¤ë§ˆíŠ¸í° ì¹´ë©”ë¼ ê¸°ìˆ  ë¹„êµ ë¶„ì„</p>
                </div>
                <h3 style="margin-top: 20px;">ğŸ“Œ Right Contents: Lifestyle</h3>
                <ul class="ranking-list" style="counter-reset: none; padding-left: 10px; list-style-type: disc;">
                    <li>ì›°ë‹ˆìŠ¤ ì—¬í–‰ì§€ ì¶”ì²œ: ëª¸ê³¼ ë§ˆìŒì„ ì¹˜ìœ í•˜ëŠ” ê³µê°„</li>
                </ul>
                
                <div id="MR_halfpage_rectangle" class="ad-slot ad-3"> 
                    <div class="gam-container">
                        </div>
                </div>
                
                <h3 style="margin-top: 20px;">ğŸ“° Quick Links</h3>
                <ul class="ranking-list" style="counter-reset: none; padding-left: 10px; list-style-type: disc;">
                    <li>ë§¤ê²½ ì§€ë©´ ë³´ê¸°</li>
                    <li>ì£¼ìš” ê³µì‹œ ì‚¬í•­</li>
                </ul>
            </div>
        </div>
    </div>

    <footer>
        <p style="text-align: center; padding: 15px; background-color: #333; color: white; margin-top: 0;">
            &copy; 2025 Mockup Site. All Rights Reserved. (ë§¤ì¼ê²½ì œ ë ˆì´ì•„ì›ƒ ëª¨ë°©)
        </p>
    </footer>

    <script>
        // ----------------------------------------------------------
        // [Lazy Load ì¸í”„ë¼]
        // ----------------------------------------------------------

        // 1. ë””ë°”ì´ìŠ¤ ì¹´í…Œê³ ë¦¬ í™•ì¸ (Head scriptì™€ ë™ì¼ ë¡œì§)
        const userAgentLazy = navigator.userAgent.toLowerCase();
        const widthLazy = window.innerWidth;
        const isDesktopLazy = !(/mobile|android|iphone|ipod/.test(userAgentLazy) && !/ipad/.test(userAgentLazy)) && widthLazy > 1024;

        /*
         * ğŸ’¡ [ìˆ˜ì • ì‘ì—… 3] ì¦‰ì‹œ ë¡œë”©(Eager)ì´ í•„ìš”í•œ ìŠ¬ë¡¯ë§Œ ì •ì˜ (ì†Œìˆ˜ ê´€ë¦¬)
         * - HOME GPT ì •ì±… (Sectionê³¼ ë™ì¼í•˜ê²Œ ìµœì í™”):
         * Â· TC_billboard_leaderboard: All devices FALSE (Eager)
         * Â· MR_halfpage_rectangle: Desktop FALSE (Eager) / Others TRUE (Lazy)
         */
        const EAGER_AD_SLOT_IDS = [
            'TC_billboard_leaderboard'
        ];

        // ğŸ’¡ [ìˆ˜ì •] ë°ìŠ¤í¬íƒ‘ì¼ ê²½ìš° MRë„ Eager ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€ (Lazy ê°ì‹œ ì œì™¸)
        if (isDesktopLazy) {
            EAGER_AD_SLOT_IDS.push('MR_halfpage_rectangle');
        }

        let lazyAdSlotsHTML = [];
        let lazyGamSlots = [];
        let lazyObserver = null;

        // ==========================================================
        // í•¨ìˆ˜ 1. Lazy Load ëŒ€ìƒ ê´‘ê³  ìŠ¬ë¡¯ ì„¤ì • ë° Observer ìƒì„±
        // ==========================================================
        function setupLazyLoading() {
            /*
             * [1ë‹¨ê³„ Â· DOMì—ì„œ Lazy ëŒ€ìƒ ìŠ¬ë¡¯ ìˆ˜ì§‘]
             * - IDê°€ EAGER_AD_SLOT_IDSì— 'í¬í•¨ë˜ì§€ ì•Šì€' ê²ƒë§Œ Lazy ëŒ€ìƒìœ¼ë¡œ ë“±ë¡
             */
            const allAdSlots = document.querySelectorAll('.ad-slot');
            lazyAdSlotsHTML = [];

            allAdSlots.forEach(slot => {
                if (!EAGER_AD_SLOT_IDS.includes(slot.id)) {
                    lazyAdSlotsHTML.push(slot);
                }
            });

            /*
             * [2ë‹¨ê³„ Â· GAMì— ì •ì˜ëœ ìŠ¬ë¡¯ ê°ì²´ í•„í„°ë§]
             * - ì œì™¸ ëª©ë¡(Eager)ì— ì—†ëŠ” ìŠ¬ë¡¯ë§Œ lazyGamSlotsì— ì €ì¥
             * - Eager ìŠ¬ë¡¯(Headì—ì„œ ì´ë¯¸ ì²˜ë¦¬)ì€ ì—¬ê¸°ì„œ ê±´ë“œë¦¬ì§€ ì•ŠìŒ (ì¤‘ë³µ ë°©ì§€)
             */
            lazyGamSlots = [];
            if (window.googletag && googletag.cmd) {
                googletag.cmd.push(function() {
                    const definedSlots = googletag.pubads().getSlots();
                    
                    // Lazy ëŒ€ìƒ í•„í„°ë§ (ì œì™¸ ëª©ë¡ì— ì—†ëŠ” ê²ƒ)
                    lazyGamSlots = definedSlots.filter(slot =>
                        !EAGER_AD_SLOT_IDS.includes(slot.getSlotElementId())
                    );

                    /* * âŒ [ì¤‘ë³µ í˜¸ì¶œ ë°©ì§€] 
                     * Head ìŠ¤í¬ë¦½íŠ¸ì—ì„œ TCì™€ MR(ë°ìŠ¤í¬íƒ‘)ì„ ì´ë¯¸ ì¼ê´„ì ìœ¼ë¡œ refresh() í–ˆìœ¼ë¯€ë¡œ
                     * ì—¬ê¸°ì„œ ì¤‘ë³µ í˜¸ì¶œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                     */
                });
            }

            /**
             * [ê°ê´€ì  ìµœì í™”: ë””ë°”ì´ìŠ¤ë³„ rootMargin ë™ì  í• ë‹¹]
             */
            const ua = navigator.userAgent.toLowerCase();
            const width = window.innerWidth;
            let marginValue = '400px'; // Desktop ê¸°ë³¸ê°’

            if ((/mobile|android|iphone|ipod/.test(ua) && !/ipad/.test(ua)) || width <= 768) {
                marginValue = '600px';
            } else if (/ipad|tablet/.test(ua) || width <= 1024) {
                marginValue = '500px';
            }

            const options = {
                root: null,
                rootMargin: `0px 0px ${marginValue} 0px`,
                threshold: 0.0
            };

            console.log(`ğŸš€ [Lazy Load] rootMargin optimized for ${marginValue} based on device detection.`);

            lazyObserver = new IntersectionObserver(function(entries, observerInstance) {
                entries.forEach(entry => {
                    if (!entry.isIntersecting) return;

                    const slotId = entry.target.id;

                    if (window.googletag && googletag.cmd) {
                        googletag.cmd.push(function() {
                            const slotToRefresh = lazyGamSlots.find(
                                s => s.getSlotElementId() === slotId
                            );

                            if (slotToRefresh) {
                                googletag.display(slotId); 
                                googletag.pubads().refresh([slotToRefresh]); 
                                console.log(`âœ… [Lazy Load SUCCESS] Ad ID: ${slotId} | Status: DISPLAY + REFRESH upon scroll (margin: ${marginValue}).`);
                            }
                        });
                    }

                    observerInstance.unobserve(entry.target);
                });
            }, options);
        }

        // ==========================================================
        // í•¨ìˆ˜ 2. Lazy Load ëŒ€ìƒ ìŠ¬ë¡¯ ê´€ì°° ì‹œì‘
        // ==========================================================
        function startObservingLazySlots() {
            if (!lazyObserver || !lazyAdSlotsHTML || lazyAdSlotsHTML.length === 0) return;
            lazyAdSlotsHTML.forEach(slot => {
                lazyObserver.observe(slot);
                console.log(`â³ [Lazy Load Register] Ad ID: ${slot.id} | Registered for Lazy Load.`);
            });
        }

        // ==========================================================
        // DOMContentLoaded ì‹œì ì— Lazy ê´€ë ¨ ë¡œì§ ì‹¤í–‰
        // ==========================================================
        document.addEventListener('DOMContentLoaded', function() {
            // [TC ë‹«ê¸° ê¸°ëŠ¥ ê´€ë ¨ UI ìˆ¨ê¹€ ì²˜ë¦¬]
            // í—¤ë“œì—ì„œ ë¡œì§ì ìœ¼ë¡œëŠ” suppression í–ˆì§€ë§Œ, DOM display:none ì²˜ë¦¬ëŠ” ì—¬ê¸°ì„œ ë³´ì™„
            if (window.googletag && googletag.cmd) {
                googletag.cmd.push(function() {
                    // ì „ì—­ í—¬í¼ í•¨ìˆ˜ê°€ ì •ì˜ë˜ì–´ ìˆë‹¤ë©´ ì²´í¬
                    if (typeof isTcBillboardSuppressedForToday === 'function' && isTcBillboardSuppressedForToday()) {
                        const tcElem = document.getElementById('TC_billboard_leaderboard');
                        if (tcElem) {
                            const outerSlot = tcElem.closest('.ad-slot') || tcElem;
                            outerSlot.style.display = 'none';
                        }
                    }
                });
            }

            setupLazyLoading(); 
            startObservingLazySlots();
        });
    </script> 
</body>
</html>