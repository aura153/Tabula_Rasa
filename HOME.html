<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOME GPT</title>
    
    <style>
        /* 
         * [공통 · 레이아웃 설명]
         * - 이 스타일 시트는 HOME GPT 레이아웃에 대한 기본 스타일이며,
         *   광고와 직접적으로 연관된 CSS(.ad-slot, .mk-ad-label 등)에 주석을 특히 강화하였습니다.
         * - View / Section / List GPT에서도 동일한 패턴을 유지하면
         *   광고개발자가 공통 로직과 파일별 차이를 한 번에 이해하기 용이합니다.
         */

        body { font-family: 'Malgun Gothic', 'Dotum', Arial, sans-serif; margin: 0; padding: 0; background-color: #f6f6f6; color: #333; }
        a { text-decoration: none; color: inherit; }
        .container { max-width: 1210px; margin: 0 auto; padding: 0 10px; }
        header { width: 100%; background-color: #fff; border-bottom: 1px solid #ddd; padding: 10px 0; text-align: center; }
        .logo { font-size: 28px; font-weight: bold; color: #000; }
        nav { background-color: #f9f9f9; border-bottom: 2px solid #333; margin-bottom: 20px; }
        .nav-list { list-style: none; padding: 0; margin: 0; display: flex; justify-content: flex-start; }
        .nav-list li { padding: 10px 15px; font-weight: bold; border-right: 1px solid #eee; }
        .nav-list li:first-child { color: #c00; }

        .content-wrap { display: flex; gap: 20px; margin-bottom: 30px; }

        /*
         * [레이아웃 · 메인/우측 컬럼 비율 전략 – View GPT와의 정렬]
         *
         * - 목적:
         *   1) 데스크탑에서 우측 사이드바 내 300px 폭 광고(300x250, 300x600 등)가
         *      잘리지 않고 온전히 노출되도록 "사이드바 영역 폭"을 보장
         *   2) 모바일/태블릿에서는 우측 컬럼이 메인 아래로 내려가면서 폭 100%를 사용하도록 설정
         *
         * - View GPT의 .related-area 전략:
         *   - 데스크탑: min-width 336px 이상 확보
         *   - 모바일/태블릿: width: 100%로 전환
         *
         * - HOME GPT의 .sidebar 전략:
         *   - 외곽 padding을 0으로 두고, 전체 컨테이너 폭을 340px로 고정
         *     → 300x600 / 300x250 소재를 여유 있게 수용(좌우 잘림 방지)
         *   - 데스크탑(≥1025px): flex: 0 0 340px; min-width: 340px
         *   - 모바일/태블릿(≤1024px): width: 100%; flex: 1 1 auto; min-width: 0;
         *
         * - 결과:
         *   - 데스크탑에서는 우측 영역 내 모든 ad-slot이 300px 폭 소재를 안정적으로 수용
         *   - 모바일/태블릿에서는 레이아웃이 세로 스택이 되며, 사이드바 폭 100%로 자연스럽게 확장
         */
        .main-content {
            flex: 1 1 auto;  /* 남은 공간을 유연하게 차지 */
            min-width: 0;
        }

        .sidebar {
            /* 
             * [사이드바 공통 스타일]
             * - 광고 수익 테스트를 위해 외곽 padding을 0으로 설정
             * - 우측 레일 전체 폭(340px) 안에서 광고/콘텐츠를 최대한 넓게 쓰기 위함
             * - 텍스트/콘텐츠 여백이 필요하면 .sidebar-item 등 내부 요소에서 padding을 부여
             */
            background-color: #fff;
            padding: 0;                 /* 🔧 기존 20px → 0으로 변경 */
            box-sizing: border-box;
            border-radius: 5px;
        }
        
        /*
         * [광고 공통 · .ad-slot 래퍼 설명 – View GPT와 정렬된 전략]
         *
         * - 이 클래스는 GPT 광고 DIV의 공통 래퍼이며,
         *   실제 GAM에서 정의한 슬롯 ID(TC_billboard_leaderboard 등)를 그대로 사용합니다.
         *
         * - 핵심 전략:
         *   1) "슬롯의 폭"은 부모 컨테이너(메인 영역/사이드바/전체 컨테이너)의 폭을 100% 사용
         *      → 광고 크기 제약은 GAM sizeMapping과 상위 레이아웃(예: .sidebar min-width)에서 제어
         *   2) height/min-height를 강제하지 않고, 실제 크리에이티브/iframe 높이에 맡김
         *      → PageSettingsConfig.collapseDiv = 'BEFORE_FETCH'와 결합해
         *        광고가 없을 때 불필요한 공백을 남기지 않음
         *   3) 라벨(Advertisement)이 들어갈 상단 여백만 padding-top으로 최소한 확보
         *
         * - View GPT와의 차이/유사점:
         *   - View GPT: .ad-slot가 flex 컨테이너로 동작하며, 광고 내용을 수평/수직 중앙 정렬
         *   - HOME GPT: 동일하게 flex 정렬을 사용하되, 일부 영역은 .gam-container와 병행 사용
         *
         * - 주의사항:
         *   - max-width는 전역에서 제거했습니다.
         *     → 우측 사이드바, 메인, 하단 등 서로 다른 레이아웃 컨텍스트에서
         *       공통 .ad-slot을 사용할 때, 의도치 않은 사이즈 제한을 피하기 위함입니다.
         *   - height/min-height를 다시 추가할 경우,
         *     "광고 미노출 시 공백" 문제가 발생할 수 있으므로 반드시 사전 검토 필요.
         */
        .ad-slot {
            position: relative;
            text-align: center;
            display: flex;              /* View GPT와 동일: flex 컨테이너 */
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            font-size: 14px;
            font-weight: bold;
            box-sizing: border-box;
            border: none;
            padding: 10px 0 0 0;        /* 상단 여백 10px (라벨 공간 확보) */
            background-color: transparent;
            width: 100%;                /* 부모 컨테이너 폭 100% 사용 */
            height: auto;               /* 높이는 실제 광고 크리에이티브에 의해 결정 */
            line-height: 1.5;
            overflow: visible;
            color: transparent;         /* 텍스트 컬러는 투명 처리 (디버그 텍스트 노출 방지) */
            z-index: 10;
        }

        /*
         * [광고 공통 · .gam-container 설명]
         *
         * - 일부 영역에서 .ad-slot 안쪽에 한 번 더 감싸는 용도로 사용되는 래퍼입니다.
         * - 역할:
         *   - display:flex로 다양한 사이즈의 광고 크리에이티브를 수평/수직 중앙 정렬
         *   - width: 100%로 부모(ad-slot) 폭에 맞추어 확장
         *
         * - View GPT에서는 .gam-container 없이 .ad-slot만으로 정렬을 처리하고 있으나,
         *   HOME GPT는 기존 마크업 호환을 유지하기 위해 .gam-container를 유지합니다.
         *
         * - min-height는 0으로 두어, 광고가 없는 경우 불필요한 공백이 생기지 않도록 합니다.
         */
        .gam-container {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-grow: 1;
            min-height: 0;
        }
        
        /*
         * [광고 개별 ID 스타일]
         * - TC_billboard_leaderboard / MC_billboard_rectangle / MR_halfpage_rectangle에 대해서는
         *   background, border를 강제로 투명 처리하여, 광고 크리에이티브만 노출되도록 합니다.
         * - 운영 환경에서 디버깅을 위해 임시로 배경색/테두리를 넣고 싶을 때는
         *   아래 !important 설정과 충돌할 수 있으니, 별도 디버그 클래스 추가를 추천드립니다.
         */
        #TC_billboard_leaderboard, #MC_billboard_rectangle, #MR_halfpage_rectangle { 
            background-color: transparent !important; 
            border: none !important; 
        }

        /*
         * [디버그 · .ad-loaded 설명]
         * - 이 클래스는 광고가 실제로 로드된 슬롯에만 동적으로 부여할 때 사용하는 디버깅용입니다.
         * - 현재 HOME GPT에서는 JS에서 직접 .ad-loaded를 붙이지 않고 있으나,
         *   향후 slotRenderEnded 이벤트에서 상태를 태깅할 때 재사용할 수 있습니다.
         * - 주의사항:
         *   - 운영 반영 시에는 실제 서비스 사용자에게 노출되지 않도록 제거 또는 색상 변경을 추천드립니다.
         */
        .ad-loaded { background-color: #c00 !important; color: #fff; }
        
        /*
         * [공통 · mk-ad-label (Advertisement 라벨) 설명]
         * - 광고 슬롯 상단에 “Advertisement” 문구를 노출하는 라벨입니다.
         * - View / HOME / Section / List GPT 공통 가이드:
         *   - 위치: .ad-slot 기준 absolute, 상단에서 -15px (슬롯 외부 위쪽에 위치)
         *   - 크기: font-size 13px, 대문자 표기(text-transform: uppercase)
         *   - 역할:
         *     1) 국내·글로벌 광고 가이드라인의 "광고 표시" 요건 충족
         *     2) slotRenderEnded 이벤트에서만 추가되어, 실제 광고가 채워졌을 때만 노출
         * - HOME 전용 특이사항:
         *   - HOME 페이지 특성상 배경이 밝은 영역이 많아, 기본 색상을 #5A5A5A로 설정했습니다.
         * - 추후 다국어 적용 시:
         *   - labelElement.textContent 값을 Locale에 따라 동적으로 변경하는 방향으로 확장 가능합니다.
         */
        .mk-ad-label {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            padding: 0;
            background-color: transparent;
            border: none;
            color: #5A5A5A;
            font-size: 13px;         /* View GPT와 통일: 13px */
            font-weight: normal;     /* 볼드 해제 */
            text-transform: uppercase;
            line-height: 1;
            white-space: nowrap;
        }
        
        @media (prefers-color-scheme: dark) {
            body { background-color: #1a1a1a; color: #e0e0e0; }
            header { background-color: #1a1a1a; border-bottom-color: #444; }
            .logo { color: #fff; } /* Dark Mode 타이틀 색상 대응 */
            nav { background-color: #1a1a1a; border-bottom: 2px solid #666; }

            /* 폭/레이아웃은 기본 .sidebar 정의를 그대로 사용하고, 다크모드에서는 색상만 변경 */
            .sidebar { background-color: #1a1a1a; border-color: #444; }
            .sidebar-item { background-color: #1a1a1a; border-color: #444; }

            /*
             * [Dark Mode · mk-ad-label]
             * - 다크 모드에서 라벨이 지나치게 튀지 않고, 동시에 충분한 대비를 확보하는 정도로 색상을 조정했습니다.
             * - View GPT에서는 약간 다른 스타일(반투명 배경)을 사용하지만,
             *   HOME에서는 배경이 상대적으로 단순하여 transparent + 회색 텍스트만 사용했습니다.
             */
            .mk-ad-label {
                background-color: transparent;
                color: #A0A0A0;
                border: none;
            }
        }

        /* ------------------------------
           데스크탑 레이아웃 (>= 1025px)
           - 우측 사이드바 340px 컨테이너 폭 확보
           - 300x600/300x250 등 세로형 광고를 수용하기에 충분한 폭 보장
        ------------------------------ */
        @media (min-width: 1025px) {
            .sidebar {
                flex: 0 0 340px;   /* 전체 폭 340px (외곽 padding 0 기준) */
                min-width: 340px;  /* 최소 폭 보장 */
            }
        }

        @media (max-width: 1024px) {
            /*
             * [반응형 레이아웃 · HOME 전용 – View GPT와 유사 전략]
             * - 1024px 이하에서는 메인/사이드 두 컬럼을 세로 방향(column)으로 배치합니다.
             * - 이 때 .sidebar는 폭 100%를 사용하며, min-width 제약을 제거합니다.
             *   → View GPT의 .related-area와 동일한 방향성 (모바일에서는 폭 100% 우선)
             * - 광고 자체의 사이즈는 GPT sizeMapping에서 제어하며,
             *   여기서는 광고 슬롯을 둘러싼 레이아웃 컨테이너 폭만 제어합니다.
             */
            .content-wrap { flex-direction: column; }

            .sidebar {
                width: 100%;
                flex: 1 1 auto;
                min-width: 0;
            }
        }
    </style>
    
    <!-- 
        [공통 · GPT 로더 스크립트]
        - View GPT에서는 securepubads.g.doubleclick.net/tag/js/gpt.js를 사용하고,
          HOME GPT에서는 기존 호환성을 위해 googletagservices.com/tag/js/gpt.js를 사용하고 있습니다.
        - 실서비스 전환 시에는 한 가지 방식으로 정리하는 것을 권장드립니다. (동작에는 영향 없음)
    -->
    <script async src='https://www.googletagservices.com/tag/js/gpt.js'></script>
    <script>
        /*
         * [공통 · googletag 전역 네임스페이스]
         * - GAM에서 제공하는 gpt.js는 window.googletag 객체를 기준으로 동작합니다.
         * - 아래 패턴은 공식 권장 초기화 방식으로, 스크립트 비동기 로딩 시에도
         *   googletag.cmd.push(...)에 등록한 콜백들이 로더가 준비된 뒤 순차 실행됩니다.
         */
        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];

        /*
         * [공통 · 다크 모드 플래그 isDarkMode]
         * - 사용자 OS/브라우저의 prefers-color-scheme: dark 여부를 읽어와,
         *   페이지 레벨 타게팅 키(is_dark_mode)에 전달합니다.
         * - 역할:
         *   - 광고주/캠페인 측에서 다크 모드 사용자에게만 노출되는 크리에이티브를 집행하는 등,
         *     크리에이티브 전략을 세분화할 수 있게 합니다.
         */
        const isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'true' : 'false';

        /*
         * [공통 · AdUnitPath 설명]
         * - AdUnitPath는 GAM 인벤토리 구조의 "광고 단위 경로(ad unit path)"를 의미합니다.
         *   예시 구조:
         *   - /7450         : 네트워크 코드 (매일경제 고유 네트워크 ID)
         *   - /www.mk.co.kr : 사이트 식별자
         *   - /HOME         : 페이지/섹션 식별자 (홈, 섹션, 뷰 등)
         *
         * - HOME GPT에서는 '/7450/www.mk.co.kr/HOME'으로 고정되어 있으나,
         *   실제 운영 시에는 다음과 같이 동적으로 변경될 수 있습니다.
         *   - 예시:
         *     - 홈:        /7450/www.mk.co.kr/HOME
         *     - 경제 섹션: /7450/www.mk.co.kr/news/economy
         *     - 증권 섹션: /7450/www.mk.co.kr/news/stock
         *
         * - 권장 구현 방식:
         *   - CMS 또는 템플릿 엔진에서 page_type, section 코드에 따라 AdUnitPath를 동적으로 주입
         *   - 예: const AdUnitPath = '/7450/www.mk.co.kr/' + PAGE_KEY_FROM_CMS;
         *   - 이렇게 하면 HOME / VIEW / SECTION / LIST 템플릿이 동일한 JS 구조를 공유할 수 있습니다.
         */
        const AdUnitPath = '/7450/www.mk.co.kr/HOME';

        // 💡 슬롯 객체 저장 (View / Section과 동일 패턴: div_id + "_slot")
        let TC_billboard_leaderboard_slot = null;
        let MC_billboard_rectangle_slot   = null;
        let MR_halfpage_rectangle_slot    = null;

        // ***************************************************
        // ✅ 광고 렌더링 완료 시 'Advertisement' 라벨을 삽입하는 함수 (전역 1회 정의)
        // ---------------------------------------------------
        // [공통 · GAM 이벤트 리스너 메커니즘]
        // - GAM은 각 광고 슬롯 렌더링이 완료될 때 slotRenderEnded 이벤트를 발생시킵니다.
        // - 아래 addAdLabel 함수는 해당 이벤트를 수신하여 실제로 광고가 채워진 슬롯에만
        //   'Advertisement' 라벨을 동적으로 삽입합니다.
        // - 특징:
        //   - event.isEmpty === false 일 때만 라벨 삽입 → 빈 슬롯에는 라벨이 붙지 않음
        //   - .ad-slot 래퍼 안에 .mk-ad-label을 prepend 형태로 삽입
        //   - 동일 슬롯에 중복 라벨이 생성되지 않도록 방지 로직 포함
        // ***************************************************
        function addAdLabel(event) {
            const slotId = event.slot.getSlotElementId();
            const slotElement = document.getElementById(slotId); 
            
            if (event.isEmpty === false && slotElement) {
                const outerSlot = slotElement.closest('.ad-slot'); 
                if (!outerSlot) return;

                // 이미 라벨이 있으면 중복 삽입 방지
                if (outerSlot.querySelector('.mk-ad-label')) return; 

                const labelElement = document.createElement('div');
                labelElement.className = 'mk-ad-label';
                labelElement.textContent = 'Advertisement';
                
                outerSlot.insertBefore(labelElement, outerSlot.firstChild);

                // 배경/보더는 투명 처리 유지
                outerSlot.style.border = 'none'; 
                outerSlot.style.backgroundColor = 'transparent';

                console.log(`✅ [Ad Label] Label added for ${slotId}`);
            }
        }
        // ***************************************************

        googletag.cmd.push(function() {
            
            // --- [1] 페이지 레벨 타게팅: GPT 버전, 디바이스, 환경 정보 ---
            // [공통 · device_category 결정 로직]
            // - userAgent + viewport 너비를 조합하여, 간단한 수준으로 디바이스 범주를 결정합니다.
            //   - mobile : UA에 mobile/android/iphone/ipad/ipod가 포함되거나, width <= 768
            //   - tablet : width <= 1024 (모바일보다 넓고 데스크탑보다는 작은 영역)
            //   - desktop: 그 외
            // - 영향 범위:
            //   1) 페이지 레벨 타게팅 키 device_category 값으로 전달되어 입찰/타게팅에 활용
            //   2) Size Mapping(반응형 광고)와는 직접 연결되어 있지 않지만,
            //      양쪽을 동일 기준으로 유지하면 리포트 분석 및 캠페인 세팅 시 혼선이 줄어듭니다.
            
            const userAgent = navigator.userAgent.toLowerCase();
            let deviceCategory = 'desktop';
            if (/mobile|android|iphone|ipad|ipod/.test(userAgent) || window.innerWidth <= 768) {
                deviceCategory = 'mobile';
            } else if (window.innerWidth <= 1024) {
                deviceCategory = 'tablet';
            }
            googletag.pubads().setTargeting('device_category', deviceCategory);
            
            /*
             * [공통 · 페이지 레벨 동적 키/값 설정]
             * - domain / url / referer:
             *   - 도메인/현재 URL/레퍼러 정보를 기반으로 구간별 성과 분석 및 리타게팅에 활용 가능
             * - is_dark_mode:
             *   - 위에서 계산한 다크 모드 플래그
             * - gpt_version:
             *   - 배포/버전 관리를 위한 내부 용도 (예: 2025 템플릿 버전)
             * - 특징:
             *   - 모든 슬롯에 공통으로 적용되는 페이지 레벨 타게팅이므로,
             *     View / HOME / Section / List 템플릿에 동일 패턴으로 유지하는 것이 좋습니다.
             */
            googletag.pubads().setTargeting('domain', window.location.hostname);
            googletag.pubads().setTargeting('url', window.location.href);
            googletag.pubads().setTargeting('referer', document.referrer);
            googletag.pubads().setTargeting('is_dark_mode', isDarkMode);
            googletag.pubads().setTargeting('gpt_version', '2025'); 

            // --- [2] CMS 정보 주입이 필요한 키-값 설정 ---
            /*
             * [HOME 전용 · 페이지 속성 키]
             * - web_type : 'responsive' → 반응형 레이아웃 페이지임을 나타냄
             * - page_type: 'HOME'       → 홈(대문) 페이지 구분을 위한 핵심 키
             * - section_home_nm: 'MK'   → 홈 기준 대표 브랜드/사이트명
             *
             * [동적입력 키]
             * - section_front_nm, section_list_nm, SOURCE_ID 등은
             *   실제 운영 시 CMS가 각 페이지 특성에 맞게 덮어써야 하는 값입니다.
             * - HOME에서는 기본적으로 '동적입력' 플레이스홀더를 사용하되,
             *   템플릿 공통 코드 유지 목적상 View/Section/List와 동일한 키 구조를 유지합니다.
             */
            googletag.pubads().setTargeting('web_type', 'responsive');
            googletag.pubads().setTargeting('page_type', 'HOME');
            googletag.pubads().setTargeting('section_home_nm', 'MK');
            
            // ▼▼▼ 동적 입력 키-값 ▼▼▼
            googletag.pubads().setTargeting('section_front_nm', '동적입력');
            googletag.pubads().setTargeting('section_list_nm', '동적입력');
            googletag.pubads().setTargeting('SOURCE_ID', '동적입력');
            googletag.pubads().setTargeting('source_type', '동적입력');
            googletag.pubads().setTargeting('MIDDLE_CODE_ENG_NM', '동적입력');
            googletag.pubads().setTargeting('CODE_ID', '동적입력');
            googletag.pubads().setTargeting('article_num', '동적입력');
            googletag.pubads().setTargeting('title', '동적입력');
            googletag.pubads().setTargeting('title_slug', '동적입력');
            googletag.pubads().setTargeting('url_slug', '동적입력');
            googletag.pubads().setTargeting('publish_date', '동적입력');
            googletag.pubads().setTargeting('journalist', '동적입력');
            googletag.pubads().setTargeting('keywords', '동적입력');
            googletag.pubads().setTargeting('ticker_name', '동적입력');
            googletag.pubads().setTargeting('has_video', '동적입력');
            googletag.pubads().setTargeting('is_app_viewer', '동적입력');
            googletag.pubads().setTargeting('login_type', '동적입력');
            googletag.pubads().setTargeting('login_status', '동적입력');
            googletag.pubads().setTargeting('membership_type', '동적입력');
            googletag.pubads().setTargeting('brandsensitive', '동적입력');
            // ▲▲▲ 동적 입력 키-값 ▲▲▲

            // --- [3] GPT 핵심 기능 설정 (PageSettingsConfig 기반) ---
            /*
             * [공통 · GAM 핵심 API 설명]
             * 1) googletag.defineSlot(adUnitPath, sizeArray, divId)
             *    - 특정 divId를 가진 DOM 요소와 GAM 인벤토리(adUnitPath)를 연결하는 슬롯을 정의합니다.
             *    - sizeArray에는 고정 사이즈 또는 'fluid' 등이 포함될 수 있으며,
             *      이후 defineSizeMapping으로 뷰포트별 실제 노출 사이즈를 제어합니다.
             *
             * 2) googletag.pubads()
             *    - Publisher Ads Service 객체로, 대부분의 공통 설정(타게팅, SRA 등)을 이 레벨에서 수행합니다.
             *
             * 3) enableSingleRequest()
             *    - SRA(Single Request Architecture)를 활성화합니다.
             *    - 한 페이지의 모든 슬롯을 하나의 네트워크 요청으로 묶어 호출하여
             *      레이턴시를 줄이고, 라인 아이템 간 경쟁/우선순위를 일관되게 평가하도록 합니다.
             *
             * 4) PageSettingsConfig.collapseDiv
             *    - 예전 collapseEmptyDivs(...)의 신규 버전(권장 방식)입니다.
             *    - collapseDiv: 'BEFORE_FETCH' 설정 시,
             *      슬롯은 처음에는 접힌 상태로 시작하고, 광고가 반환되면 확장됩니다.
             *      → 기존 collapseEmptyDivs(true)와 동등한 동작.
             *
             * 5) disableInitialLoad()
             *    - 페이지 로드 시점에 자동으로 광고 요청을 보내지 않도록 차단합니다.
             *    - 이후 개발자가 display() + refresh()를 호출하는 시점에서만 요청이 발생하며,
             *      이 패턴이 Lazy Load/뷰포트 기반 로딩의 핵심 전제 조건이 됩니다.
             *
             * 6) PageSettingsConfig.centering
             *    - 작은 사이즈의 광고가 큰 div 안에 들어갈 때, 중앙 정렬되도록 합니다.
             *    - HOME/VIEW 모두 크기가 다양한 배너를 하나의 슬롯에 집행하는 경우가 많기 때문에,
             *      화면 균형 측면에서 유용한 옵션입니다.
             */

            googletag.pubads().enableSingleRequest();
            googletag.pubads().setPublisherProvidedId('PPID_DYNAMIC_HASHED_ID (SERVER_HASHED_ID)');
            googletag.pubads().disableInitialLoad(); 

            // ✅ PageSettingsConfig: centering + collapseDiv 전역 설정
            googletag.setConfig({
                centering: true,             // 수평 가운데 정렬
                collapseDiv: 'BEFORE_FETCH'  // collapseEmptyDivs(true)와 동등한 동작
            });
            
            // ✅ GAM 이벤트 리스너 추가 (라벨)
            googletag.pubads().addEventListener('slotRenderEnded', addAdLabel);

            // --- [4] Size Mapping 정의 (2개로 분리 적용) ---
            /*
             * [공통 · 반응형 광고 구현 로직 개요]
             * - sizeMapping은 "뷰포트 크기에 따라 어떤 사이즈 조합을 허용할지"를 정의하는 객체입니다.
             * - addSize([viewportWidth, viewportHeight], [허용 광고 사이즈 목록])
             *   예) [1024, 0] 이상일 때는 데스크탑용 대형 배너, 그보다 작으면 모바일용 소형 배너
             *
             * - HOME GPT에서는:
             *   - sizeMapping_horizontal     : 상단/중단의 가로형 배너(TC, MC)에 공통 적용
             *   - sizeMapping_right_square   : 오른쪽 MR 박스형 배너에 적용
             * - 실제 입찰 단계에서 GAM은 이 매핑 정보를 사용해, 뷰포트에 맞는 크리에이티브만 선별하여 노출합니다.
             */

            // 0-1. 가로형 배너용 사이즈 매핑 (TC, MC)
            const sizeMapping_horizontal = googletag.sizeMapping()
                .addSize([1024, 0], [[1200, 300], [1200, 100], [970, 250], [980, 120], [970, 90], [930, 180], [728, 90], [2, 1], [1, 1], 'fluid'])
                .addSize([768, 0], [[750, 300], [750, 200], [728, 90], [480, 320], [336, 280], [300, 250], [2, 1], [1, 1], 'fluid'])
                .addSize([0, 0], [[336, 280], [300, 250], [320, 480], [320, 100], [320, 50], [250, 250], [200, 200], [2, 1], [1, 1], 'fluid'])
                .build();

            // 0-2. 우측 박스형 배너용 사이즈 매핑 (MR)
            const sizeMapping_right_square = googletag.sizeMapping()
                .addSize([1024, 0], [[300, 600], [300, 250], [250, 250], [200, 200], [2, 1], [1, 1], 'fluid'])
                .addSize([768, 0], [[480, 320], [336, 280], [320, 100], [320, 50], [300, 250], [250, 250], [200, 200], [2, 1], [1, 1], 'fluid'])
                .addSize([0, 0], [[336, 280], [320, 480], [320, 100], [320, 50], [300, 250], [250, 250], [200, 200], [2, 1], [1, 1], 'fluid'])
                .build();
            // ----------------------------------------------------]
            
            // 2. 광고 슬롯 정의 (Method Chaining 및 분리된 매핑 적용)
            /*
             * [공통 · 슬롯 레벨 타게팅 사용 패턴]
             * - 각 defineSlot 이후 setTargeting('div_id', '...') 등으로 슬롯별 메타 정보를 부여하고 있습니다.
             * - 공통 필드 예:
             *   - div_id       : DOM ID와 동일 값 (디버깅 및 리포팅 시 유용)
             *   - load_type    : eager / lazy (로딩 전략 구분용, 리포트에서 필터 가능)
             *   - position     : TC, MC, MR 등 페이지 내 상대 위치
             *   - ad_area_type : ATF, in_article, below_comments 등 구체 노출 맥락
             *   - default_exposure : "기본 노출 여부"나 실험군/대조군 구분에 활용 가능
             *
             * - 페이지 레벨 키와의 관계:
             *   - 페이지 레벨 키(예: device_category, page_type)는 전체 공통 필터,
             *   - 슬롯 레벨 키(예: position, ad_area_type)는 세부 위치/역할 구분에 사용됩니다.
             */

            // TC_billboard_leaderboard (Eager Load) - sizeMapping_horizontal 적용
            TC_billboard_leaderboard_slot = googletag.defineSlot(
                AdUnitPath,
                [[1200, 300], [1200, 100], [980, 120], [970, 250], [970, 90], [930, 180], [728, 90], [320, 100], [320, 50], [1, 1], 'fluid'],
                'TC_billboard_leaderboard'
            )
                .defineSizeMapping(sizeMapping_horizontal) 
                .setTargeting('div_id', 'TC_billboard_leaderboard')
                .setTargeting('load_type', 'eager')          // 페이지 진입 즉시 노출되는 Eager 슬롯
                .setTargeting('position', 'TC')              // Top Center 영역
                .setTargeting('ad_area_type', 'ATF')         // Above The Fold 영역
                .setTargeting('default_exposure', 'hidden')  // 필요 시 기본 노출 여부를 제어할 수 있는 플래그
                .addService(googletag.pubads());

            // MC_billboard_rectangle (Lazy Load) - sizeMapping_horizontal 적용
            MC_billboard_rectangle_slot = googletag.defineSlot(
                AdUnitPath,
                [[1200, 300], [1200, 100], [980, 120], [970, 250], [970, 90], [930, 180], [750, 300], [750, 200], [728, 90], [480, 320], [336, 280], [320, 480], [320, 100], [320, 50], [300, 250], [250, 250], [200, 200], [2, 1], [1, 1], 'fluid'],
                'MC_billboard_rectangle'
            )
                .defineSizeMapping(sizeMapping_horizontal) 
                .setTargeting('div_id', 'MC_billboard_rectangle')
                .setTargeting('load_type', 'lazy')           // Lazy 로딩 대상
                .setTargeting('position', 'MC')              // Main Contents 하단
                .setTargeting('ad_area_type', '')            // 추후 'mid_home' 등으로 구체화 가능
                .setTargeting('default_exposure', '') 
                .addService(googletag.pubads());

            // MR_halfpage_rectangle (Lazy Load) - sizeMapping_right_square 적용
            MR_halfpage_rectangle_slot = googletag.defineSlot(
                AdUnitPath,
                [[480, 320], [336, 280], [320, 480], [320, 100], [320, 50], [300, 600], [300, 250], [250, 250], [200, 200], [2, 1], [1, 1], 'fluid'],
                'MR_halfpage_rectangle'
            )
                .defineSizeMapping(sizeMapping_right_square) 
                .setTargeting('div_id', 'MR_halfpage_rectangle')
                .setTargeting('load_type', 'lazy')           // 사이드바 내 Lazy 로딩 대상
                .setTargeting('position', 'MR')              // Right(MR) 영역
                .setTargeting('ad_area_type', '')            // 추후 'right_rail' 등으로 구체화 가능
                .setTargeting('default_exposure', '')                
                .addService(googletag.pubads());
            
            /*
             * [공통 · enableServices() 호출 시점]
             * - 모든 defineSlot, 페이지 레벨 설정이 끝난 직후 1회 호출합니다.
             * - 이후에는 display(), refresh()를 통해 실제 요청/렌더링이 가능해집니다.
             */
            googletag.enableServices();

            // 🟢 Eager Load용 TC는 BODY 쪽에서 display + refresh 호출
            console.log('▶️ [GPT INIT] Services enabled. TC_billboard_leaderboard will be displayed via body script.');
        });
    </script>
</head>
<body>

    <header>
        <div class="container">
            <div class="logo">HOME GPT</div>
        </div>
    </header>

    <nav>
        <div class="container">
            <ul class="nav-list">
                <li>HOME</li>
                <li>뉴스종합</li>
                <li>부동산</li>
                <li>증권</li>
                <li>오피니언</li>
                <li>스포츠</li>
            </ul>
        </div>
    </nav>
    
    <div class="container">
        
        <div id="TC_billboard_leaderboard" class="ad-slot ad-1 gam-container">
            <div class="gam-container">
                <script>
                    /*
                     * [HOME 전용 · Eager Load 구현 로직]
                     * - disableInitialLoad()를 사용했기 때문에, 광고 호출은 개발자가 직접 제어해야 합니다.
                     * - TC_billboard_leaderboard는 홈 상단 핵심 인벤토리이므로
                     *   페이지 로드 시점에 바로 display + refresh를 호출하여 즉시 노출하도록 설계했습니다.
                     *
                     * 동작 순서:
                     * 1) googletag.display('TC_billboard_leaderboard')
                     *    - 해당 div ID에 GPT iframe을 렌더링합니다.
                     * 2) googletag.pubads().refresh([TC_billboard_leaderboard_slot])
                     *    - 방금 정의된 슬롯을 대상으로 광고 요청을 전송합니다.
                     *
                     * 주의사항:
                     * - TC_billboard_leaderboard_slot 객체는 상단 스크립트에서 이미 정의/생성되어 있어야 합니다.
                     * - View / Section / List에서도 Eager 슬롯이 있다면 동일 패턴을 재사용하는 것을 권장드립니다.
                     */
                    // BODY에서 Eager Load: display + refresh
                    googletag.cmd.push(function() { 
                        googletag.display('TC_billboard_leaderboard');
                        googletag.pubads().refresh([TC_billboard_leaderboard_slot]);
                        console.log("▶️ [Immediate Load] Ad ID: TC_billboard_leaderboard | DISPLAY + REFRESH called on page load.");
                    });
                </script>
            </div>
        </div>

        <div class="content-wrap">
            <div class="main-content">
                <!-- (콘텐츠 영역: 광고 로직과 직접적인 연관은 없어 주석 생략) -->
                <section class="highlight-news">
                    <h2>🔥 Main Contents: Highlight News</h2>
                    <p style="font-size: 20px; font-weight: bold; margin-bottom: 5px;">**美 빅테크, AI 주도권 경쟁 심화... 투자 급증 속 규제 리스크 부상**</p>
                    <p style="font-size: 14px; color: #555;">* AI 반도체 수급난 장기화... K-반도체 업계 새로운 전략 모색</p>
                    <ul style="list-style: disc; padding-left: 20px; margin-top: 5px; color: #007bff;">
                        <li>차세대 LLM 모델 공개, 초거대 AI 경쟁의 서막</li>
                        <li>생성형 AI의 확산, 콘텐츠 산업에 미치는 영향 분석</li>
                    </ul>
                </section>
                <section class="article-section">
                    <h2>💰 Main Contents: Market & Finance</h2>
                    <p style="font-size: 20px; font-weight: bold; margin-bottom: 5px;">**금리 인하 기대감 '주춤'... 코스피 2700선 공방 장기화 예상**</p>
                    <p style="font-size: 14px; color: #555;">* 부동산 PF 리스크 재부각, 금융당국 '선제적 대응' 주문</p>
                    <div class="news-item">
                        <div class="news-item-img"></div>
                        <p style="margin: 0; font-weight: bold;">[속보] 원/달러 환율, 장중 1,350원 돌파... 수출 기업 희비 교차</p>
                    </div>
                </section>
                <div class="spacer-section">
                    <h3>💡 Special Feature: Future Tech</h3>
                    <p style="font-size: 16px;">**우주 경제 시대 개막: 민간 우주선, 저궤도 통신망 경쟁 가열**</p>
                    <ul style="list-style: square; padding-left: 20px; margin-top: 5px;">
                        <li>차세대 LLM 모델 공개, 초거대 AI 경쟁의 서막</li>
                        <li>양자 컴퓨터 상용화, 보안 패러다임 변화 예고</li>
                    </ul>
                </div>
            </div>
            
            <div class="sidebar">
                <h3>⭐ Right Contents: Popular Ranking</h3>
                <ul class="ranking-list">
                    <li>1. [단독] 2026년 가계부채 전망 보고서...</li>
                    <li>2. 테슬라 다음은 이 기업? 로봇주 주목</li>
                    <li>3. 상반기 최고 수익률 펀드 리스트 공개</li>
                </ul>
                <div class="sidebar-item">
                    <h4>Quick Stats</h4>
                    <p>코스피: +0.5% | 나스닥: -0.2%</p>
                </div>
                <div class="sidebar-item">
                    <h4>Editorial Picks</h4>
                    <p>논설: "AI 윤리, 기업의 사회적 책임으로"</p>
                </div>
            </div>
        </div>
        
        <div id="MC_billboard_rectangle" class="ad-slot ad-2">
            <div class="gam-container">
                <!-- MC_billboard_rectangle는 Lazy Load 대상이므로 여기서는 display 호출을 하지 않습니다. -->
            </div>
        </div>

        <div class="content-wrap">
            <div class="main-content">
                <section class="article-section">
                    <h2>🌍 Sub Contents: Global Issue</h2>
                    <p style="font-size: 20px; font-weight: bold; margin-bottom: 5px;">**유럽, 녹색 전환 가속... 탄소 국경세 도입 현실화**</p>
                    <div class="news-item">
                        <div class="news-item-img"></div>
                        <p style="margin: 0; font-weight: bold;">러시아-우크라이나 전쟁 장기화, 국제 에너지 시장 불안정 심화</p>
                    </div>
                </section>
                <div class="spacer-section">
                    <h3>🎭 Sub Contents: Society & Culture</h3>
                    <p style="font-size: 16px;">**OTT 구독료 인상 도미노... 소비자 부담 증가 논란**</p>
                    <ul style="list-style: circle; padding-left: 20px; margin-top: 5px;">
                        <li>MZ세대 '갓생' 트렌드 속 숨겨진 의미</li>
                    </ul>
                </div>
                <div class="spacer-section" style="border-left-color: #38761d;">
                    <h3>📝 Policy Briefing</h3>
                    <p style="font-size: 16px;">**정부, 저출산 대책 발표... 파격적인 주거 지원 방안 포함**</p>
                </div>
            </div>
            
            <div class="sidebar">
                <h3>📌 Right Contents: Investment Tips</h3>
                <ul class="ranking-list" style="counter-reset: none; padding-left: 10px; list-style-type: disc;">
                    <li>인플레이션 헤지 포트폴리오 구축 전략</li>
                </ul>
                <h3 style="margin-top: 20px;">📌 Right Contents: Tech Review</h3>
                <div class="sidebar-item">
                    <p>최신 스마트폰 카메라 기술 비교 분석</p>
                </div>
                <h3 style="margin-top: 20px;">📌 Right Contents: Lifestyle</h3>
                <ul class="ranking-list" style="counter-reset: none; padding-left: 10px; list-style-type: disc;">
                    <li>웰니스 여행지 추천: 몸과 마음을 치유하는 공간</li>
                </ul>
                
                <div id="MR_halfpage_rectangle" class="ad-slot ad-3"> 
                    <div class="gam-container">
                        <!-- MR_halfpage_rectangle 역시 Lazy Load 대상 → 아래 IntersectionObserver에서 제어 -->
                    </div>
                </div>
                
                <h3 style="margin-top: 20px;">📰 Quick Links</h3>
                <ul class="ranking-list" style="counter-reset: none; padding-left: 10px; list-style-type: disc;">
                    <li>매경 지면 보기</li>
                    <li>주요 공시 사항</li>
                </ul>
            </div>
        </div>
    </div>

    <footer>
        <p style="text-align: center; padding: 15px; background-color: #333; color: white; margin-top: 0;">
            &copy; 2025 Mockup Site. All Rights Reserved. (매일경제 레이아웃 모방)
        </p>
    </footer>

    <script>
        // ----------------------------------------------------------
        // View GPT와 일관된 Lazy Load 구조
        //  - LAZY_AD_SLOT_IDS: Lazy 대상 슬롯 ID 목록
        //  - lazyAdSlotsHTML: DOM 요소 목록
        //  - lazyGamSlots: GAM 슬롯 객체 목록
        //  - lazyObserver: IntersectionObserver 인스턴스
        // ----------------------------------------------------------
        /*
         * [공통 · Lazy Load 개념 및 HOME 적용 범위]
         * - Lazy Load는 "사용자 뷰포트에 근접했을 때만 광고를 요청"하는 전략입니다.
         * - 전제 조건:
         *   1) googletag.pubads().disableInitialLoad() 호출
         *   2) IntersectionObserver 또는 스크롤 이벤트를 활용해, 조건을 만족할 때
         *      googletag.display(slotId) + googletag.pubads().refresh([slot]) 호출
         *
         * - HOME GPT에서 Lazy 대상:
         *   - MC_billboard_rectangle    : 메인 중간 영역 배너
         *   - MR_halfpage_rectangle     : 우측 사이드바 하프페이지/박스형 배너
         * - View GPT에서는 in-article + 하단 BC/Native 슬롯까지 포함하는 등 범위가 더 넓으며,
         *   HOME은 상대적으로 단순한 구조로 구성되어 있습니다.
         */
        const LAZY_AD_SLOT_IDS = [
            'MC_billboard_rectangle',
            'MR_halfpage_rectangle'
        ];

        let lazyAdSlotsHTML = [];
        let lazyGamSlots = [];
        let lazyObserver = null;

        // ==========================================================
        // 함수 1. Lazy Load 대상 광고 슬롯 설정 및 Observer 생성
        // ==========================================================
        function setupLazyLoading() {
            /*
             * [1단계 · DOM에서 Lazy 대상 슬롯 수집]
             * - .ad-slot 클래스를 가진 모든 요소 중 LAZY_AD_SLOT_IDS에 포함된 ID만 추려냅니다.
             * - 이후 IntersectionObserver로 관찰할 대상 목록(lazyAdSlotsHTML)에 저장합니다.
             */
            const allAdSlots = document.querySelectorAll('.ad-slot');
            lazyAdSlotsHTML = [];

            allAdSlots.forEach(slot => {
                if (LAZY_AD_SLOT_IDS.includes(slot.id)) {
                    lazyAdSlotsHTML.push(slot);
                }
            });
            
            lazyGamSlots = [];
            
            /*
             * [2단계 · GAM에 정의된 슬롯 객체 필터링]
             * - googletag.pubads().getSlots()로 현재 페이지에 정의된 모든 슬롯을 가져온 뒤,
             *   LAZY_AD_SLOT_IDS에 포함되는 것만 lazyGamSlots에 저장합니다.
             * - 주의사항:
             *   - 이 로직은 googletag.cmd.push 내부에서 실행되어야,
             *     defineSlot/enableServices 이후 안전하게 슬롯 목록을 조회할 수 있습니다.
             */
            if (window.googletag && googletag.cmd) {
                googletag.cmd.push(function() {
                    const definedSlots = googletag.pubads().getSlots();
                    lazyGamSlots = definedSlots.filter(slot =>
                        LAZY_AD_SLOT_IDS.includes(slot.getSlotElementId())
                    );
                });
            }

            /*
             * [3단계 · IntersectionObserver 설정]
             * - root      : null → viewport 기준
             * - rootMargin: '0px 0px 100px 0px'
             *   → 실제 뷰포트보다 100px 아래에 도달했을 때 미리 로딩을 시작 (프리-로딩 효과)
             * - threshold : 0.0
             *   → 대상 요소가 1px이라도 보이기 시작하면 isIntersecting === true
             */
            const options = {
                root: null, 
                rootMargin: '0px 0px 100px 0px', 
                threshold: 0.0
            };

            /*
             * [4단계 · Observer 콜백]
             * - entry.isIntersecting === true 인 슬롯만 처리합니다.
             * - 처리 순서:
             *   1) slotId 추출 (entry.target.id)
             *   2) GAM 슬롯 객체(lazyGamSlots) 중 해당 slotId와 매칭되는 객체 찾기
             *   3) display(slotId) + refresh([slotToRefresh]) 호출
             *   4) observerInstance.unobserve(entry.target)로 한 번 로딩된 슬롯은 더 이상 관찰하지 않음
             *
             * - Eager/Lazy 공통 로직 관점:
             *   - Eager: 페이지 로드시 곧바로 display + refresh
             *   - Lazy : 페이지 로드 이후, 스크롤/관찰 조건 충족 시점에 display + refresh
             */
            lazyObserver = new IntersectionObserver(function(entries, observerInstance) {
                entries.forEach(entry => {
                    if (!entry.isIntersecting) return;

                    const slotId = entry.target.id;

                    if (window.googletag && googletag.cmd) {
                        googletag.cmd.push(function() {
                            const slotToRefresh = lazyGamSlots.find(
                                s => s.getSlotElementId() === slotId
                            );

                            if (slotToRefresh) {
                                // disableInitialLoad() 환경 → display + refresh 패턴
                                googletag.display(slotId); 
                                googletag.pubads().refresh([slotToRefresh]); 
                                console.log(`✅ [Lazy Load SUCCESS] Ad ID: ${slotId} | Status: DISPLAY + REFRESH upon scroll.`);
                            }
                        });
                    }

                    observerInstance.unobserve(entry.target);
                });
            }, options);
        }

        // ==========================================================
        // 함수 2. Lazy Load 대상 슬롯 관찰 시작
        // ==========================================================
        function startObservingLazySlots() {
            /*
             * [공통 · 관찰 시작 함수]
             * - setupLazyLoading()에서 생성된 lazyObserver와 lazyAdSlotsHTML을 사용해
             *   실제 DOM 요소를 관찰하기 시작합니다.
             * - HOME/VIEW/SECTION/LIST에서 동일 네이밍과 구조를 사용하면,
             *   공통 유틸 함수로 묶어 관리하기 용이합니다.
             */
            if (!lazyObserver || !lazyAdSlotsHTML || lazyAdSlotsHTML.length === 0) return;

            lazyAdSlotsHTML.forEach(slot => {
                lazyObserver.observe(slot);
                console.log(`⏳ [Lazy Load Register] Ad ID: ${slot.id} | Registered for Lazy Load.`);
            });
        }

        // ==========================================================
        // DOMContentLoaded 시점에 Lazy 관련 로직 실행
        // ==========================================================
        document.addEventListener('DOMContentLoaded', function() {
            /*
             * [공통 · DOMContentLoaded 활용 이유]
             * - DOMContentLoaded 시점에는 HTML 구조와 광고 슬롯 DIV가 모두 렌더링 완료된 상태이므로,
             *   광고 슬롯 재배치/관찰 설정을 수행하기에 가장 적절합니다.
             * - HOME GPT에서는:
             *   - in-article 동적 삽입은 없고, Lazy 대상 슬롯만 IntersectionObserver로 관리합니다.
             * - View GPT에서는:
             *   - DOMContentLoaded에서 in-article 광고 DOM 재배치 + Lazy 설정까지 함께 수행합니다.
             */
            setupLazyLoading();        // Lazy 대상 수집 및 Observer 초기화
            startObservingLazySlots(); // Lazy 대상 슬롯 관찰 시작
        });

        // ※ addAdLabel 및 이벤트 리스너는 <head> 영역에서 전역 1회만 등록
    </script>
</body>
</html>
