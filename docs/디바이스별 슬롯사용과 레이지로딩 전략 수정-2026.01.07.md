# DeviceCategoryë³„ ìŠ¬ë¡¯ ë° ë¡œë”© ì „ëµ ìµœì í™” ì‘ì—… - 2026.01.07

 - ë””ë°”ì´ìŠ¤ë³„ ìŠ¬ë¡¯ì‚¬ìš©ì—¬ë¶€/ ë””ë°”ì´ìŠ¤ë³„ ë¡œë”© ì „ëµ (Eager/Lazy) ì„¸ë¶„í™” ë° ìµœì í™” ì§„í–‰
 - ëŒ€ìƒ : `View`, `HOME`, `Section`, `List` 
 - ê¸°ì¡´ deviceCategory (smartphone, desktop, tabletìœ¼ë¡œ êµ¬ë¶„) ì´ìš©
---

## 1. ì „ì—­ ê³µí†µ ì—…ë°ì´íŠ¸ ì‚¬í•­

ëª¨ë“  í…œí”Œë¦¿(`View`, `HOME`, `Section`, `List`)ì— ê³µí†µìœ¼ë¡œ ì ìš©ëœ ì•„í‚¤í…ì²˜ ë³€ê²½ ì‚¬í•­.

### 1-1. GPT ì„¤ì • ê°ì²´ í†µí•© ë° ìµœì‹ í™”
- ì¢…ë£Œ ì˜ˆì •ì¸ enableSingleRequest();, disableInitialLoad();ì„ ìµœì‹ í™” í•˜ê³ , ê°œë³„ ë©”ì„œë“œ í˜¸ì¶œ ë°©ì‹ì„ GPT ìµœì‹  í‘œì¤€ì¸ `googletag.setConfig` ì¸í„°í˜ì´ìŠ¤ë¡œ í†µí•©í•¨.

* **ë³€ê²½ ì „:** `pubads().enableSingleRequest()`, `pubads().disableInitialLoad()` ë“± ê°œë³„ í˜¸ì¶œ
* **ë³€ê²½ í›„:**
    ```javascript
    googletag.setConfig({
        singleRequest: true,        // SRA(Single Request Architecture) í™œì„±í™”
        disableInitialLoad: true,   // ì´ˆê¸° ë¡œë“œ ë°©ì§€ (Lazy Load í•„ìˆ˜ ì „ì œ)
        centering: true,            // í¬ë¦¬ì—ì´í‹°ë¸Œ ìˆ˜í‰ ì¤‘ì•™ ì •ë ¬
        collapseDiv: 'BEFORE_FETCH' // ë¹ˆ ìŠ¬ë¡¯ ì˜ì—­ ì„ ì œì  ë¶•ê´´ (CLS ë°©ì§€)
    });
    ```

### 1-2. Lazy Load ë¡œì§ì„ Lazy load ëŒ€ìƒì´ ì•„ë‹Œ ë¦¬ìŠ¤íŠ¸ Lazy load 'ì œì™¸' íŒ¨í„´ìœ¼ë¡œ ë³€ê²½
ê¸°ì¡´ì˜ Lazy Load ëŒ€ìƒ ìŠ¬ë¡¯ì„ ì¼ì¼ì´ ë‚˜ì—´í•˜ë˜ ë°©ì‹(Whitelist)ì—ì„œ, **ê°¯ìˆ˜ê°€ ì‘ì€ ì¦‰ì‹œ ë¡œë“œ(Eager) ìŠ¬ë¡¯ë“¤ë§Œ ê´€ë¦¬í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ëª¨ë‘ ìë™ìœ¼ë¡œ Lazy Load ì²˜ë¦¬í•˜ëŠ” ë°©ì‹(Blacklist)**ìœ¼ë¡œ ë¡œì§ì„ ë°˜ì „.

* **ëª©ì :** ìš´ì˜ í¸ì˜ ë° Human Error(ëˆ„ë½) ë°©ì§€
* **êµ¬í˜„:**
    * ìƒìˆ˜ ë³€ê²½: `LAZY_AD_SLOT_IDS` â†’ **`EAGER_AD_SLOT_IDS`** (ì¦‰ì‹œ ë¡œë“œ ëŒ€ìƒ ì¤‘ì‹¬ìœ¼ë¡œ ê´€ë¦¬)
    * Observer ë¡œì§: `!EAGER_AD_SLOT_IDS.includes(id)` ì¡°ê±´ìœ¼ë¡œ Lazy ëŒ€ìƒ ìë™ ìˆ˜ì§‘.
    * ì¦‰, ì œì™¸ ëª©ë¡(`EAGER_AD_SLOT_IDS`)ì— **ì—†ëŠ”** ìŠ¬ë¡¯ë§Œ ìë™ìœ¼ë¡œ Lazy Load ëŒ€ìƒìœ¼ë¡œ ìˆ˜ì§‘ (Blacklist ë°©ì‹).
    * Eager ì²˜ë¦¬: `googletag.cmd` ì´ˆê¸°í™” ì‹œì ì— `EAGER_AD_SLOT_IDS`ì— í¬í•¨ëœ ìŠ¬ë¡¯ì€ ì¦‰ì‹œ `refresh()` í˜¸ì¶œ
    * ì•„ë˜ ë¶€ë¶„ì— ëŒ€í•œ ì—…ë°ì´íŠ¸ë¥¼ ì œì™¸í•˜ê³  ê¸°ì¡´, **setupLazyLoading, DOMContentLoaded, IntersectionObserver, ObservingLazySlots ê´€ë ¨ ë¡œì§** ì½”ë”©ì—ëŠ” ìˆ˜ì •ì‚¬í•­ ë¶ˆí•„ìš”


### 1-3. ìˆ˜ì •ëœ ì½”ë“œ (View í˜ì´ì§€ ê¸°ì¤€ ìƒ˜í”Œ)

### ìµœì í™” 1: Eager Slot ì •ì˜ (ìˆ˜ì •ëœ íƒœê·¸)

```javascript
// ğŸ’¡ [ìˆ˜ì • ì‘ì—… 5] ì¦‰ì‹œ ë¡œë”©(Eager)ì´ í•„ìš”í•œ ìŠ¬ë¡¯ë§Œ ì •ì˜ (ì†Œìˆ˜ ê´€ë¦¬)
const EAGER_AD_SLOT_IDS = [
    'TC_billboard_leaderboard', // ìƒë‹¨ ë¹Œë³´ë“œ (Home/Section ë“±ì—ì„œ ì‚¬ìš©, ì•ˆì „ì¥ì¹˜)
    'TC_billboard_X'            // View ìƒë‹¨ ë¹Œë³´ë“œ
];

// ğŸ’¡ [ìˆ˜ì • ì‘ì—… 3, 5] ë°ìŠ¤í¬í†±ì¼ ë•Œ ì¶”ê°€ë¡œ ì¦‰ì‹œ ë¡œë“œí•  ìŠ¬ë¡¯ë“¤ ë°˜ì˜
if (isDesktop) {
    EAGER_AD_SLOT_IDS.push('MR_side_rail_X'); // ìš°ì¸¡ ë ˆì¼
    EAGER_AD_SLOT_IDS.push('BC_native_list_1', 'BC_native_list_2'); // Native ë¦¬ìŠ¤íŠ¸ ê´‘ê³  (ë°ìŠ¤í¬í†± Eager)
}

let lazyAdSlotsHTML = [];
let lazyGamSlots = [];
let lazyObserver = null; 
```

### ìµœì í™” 2. Lazy Load ëŒ€ìƒ ê´‘ê³  ìŠ¬ë¡¯ ì„¤ì • ë° Observer ìƒì„± (ğŸ’¡ ìˆ˜ì • ì‘ì—… 5 ì ìš©)

**ì£¼ìš” ë³€ê²½ ì‚¬í•­:**
* **ê¸°ì¡´:** ê³ ì •ëœ `LAZY_AD_SLOT_IDS` ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆœíšŒ (Whitelist ë°©ì‹)
* **ë³€ê²½:** DOMì˜ ëª¨ë“  `.ad-slot`ì„ ìˆœíšŒí•˜ë©° `EAGER_AD_SLOT_IDS`ì— **ì—†ëŠ”** ê²ƒë§Œ ìë™ ìˆ˜ì§‘ (Blacklist ë°©ì‹)

```javascript
// ==========================================================
// í•¨ìˆ˜ 2. Lazy Load ëŒ€ìƒ ê´‘ê³  ìŠ¬ë¡¯ ì„¤ì • ë° Observer ìƒì„± (ğŸ’¡ ìˆ˜ì • ì‘ì—… 5 ì ìš©)
//
// - ê¸°ì¡´: ê³ ì •ëœ LAZY_AD_SLOT_IDS ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆœíšŒ
// - ë³€ê²½: DOMì˜ ëª¨ë“  .ad-slotì„ ìˆœíšŒí•˜ë©° EAGER_AD_SLOT_IDSì— ì—†ëŠ” ê²ƒë§Œ ìë™ ìˆ˜ì§‘ (Blacklist ë°©ì‹)
// ==========================================================
function setupLazyLoading() {
    // 1) DOM ìƒì—ì„œ Lazy ëŒ€ìƒ ìŠ¬ë¡¯ ìˆ˜ì§‘ (ì œì™¸ ë¦¬ìŠ¤íŠ¸ ë°©ì‹ ì ìš©)
    const allAdSlots = document.querySelectorAll('.ad-slot, .native-ad-list-item');
    lazyAdSlotsHTML = [];

    allAdSlots.forEach(slot => {
        // â­ ìˆ˜ì •: IDê°€ EAGER_AD_SLOT_IDSì— 'í¬í•¨ë˜ì§€ ì•Šì€' ê²ƒë§Œ Lazy ëŒ€ìƒìœ¼ë¡œ ë“±ë¡
        if (slot.id && !EAGER_AD_SLOT_IDS.includes(slot.id)) {
            lazyAdSlotsHTML.push(slot);
        }
    });

    // 2) GAM ìŠ¬ë¡¯ ê°ì²´ í•„í„°ë§ (ì œì™¸ ë¦¬ìŠ¤íŠ¸ ë°©ì‹ ì ìš©)
    lazyGamSlots = [];
    if (window.googletag && googletag.cmd) {
        googletag.cmd.push(function () {
            const definedSlots = googletag.pubads().getSlots();

            // â­ ìˆ˜ì •: ì œì™¸ ëª©ë¡ì— ì—†ëŠ” ìŠ¬ë¡¯ë§Œ í•„í„°ë§í•˜ì—¬ lazyGamSlotsì— ì €ì¥
            lazyGamSlots = definedSlots.filter(slot =>
                !EAGER_AD_SLOT_IDS.includes(slot.getSlotElementId())
            );

            // [ì¶”ê°€ ê¸°ëŠ¥] ì¦‰ì‹œ ë¡œë“œ ëŒ€ìƒ(Eager)ì€ ì´ ì‹œì ì— ë°”ë¡œ refresh í˜¸ì¶œ
            const eagerSlots = definedSlots.filter(slot =>
                EAGER_AD_SLOT_IDS.includes(slot.getSlotElementId())
            );
            
            if (eagerSlots.length > 0) {
                // TC_billboard_X ë“± ì´ë¯¸ ìƒë‹¨ì—ì„œ í˜¸ì¶œëœ ê²ƒê³¼ ì¤‘ë³µë˜ì§€ ì•Šë„ë¡ refresh
                // (í•„ìš” ì‹œ ì¤‘ë³µ í˜¸ì¶œ ë°©ì§€ ë¡œì§ ì¶”ê°€ ê°€ëŠ¥, ì—¬ê¸°ì„œëŠ” ëª…ì‹œì  í˜¸ì¶œ ë³´ì¥)
                // ë‹¨, display()ëŠ” body ë‚´ scriptì—ì„œ ì´ë¯¸ ì²˜ë¦¬ë¨ì„ ê°€ì •í•˜ê±°ë‚˜ í™•ì¸ í•„ìš”
                googletag.pubads().refresh(eagerSlots);
                console.log("âš¡ [Eager Load] Immediate refresh for:", eagerSlots.map(s => s.getSlotElementId()));
            }
        });
    }
}
```

### (ì°¸ê³ ) DeviceCategory(desktop, tablet, smartphone) ì— ë”°ë¼ ì‚¬ìš©í•  ê´‘ê³  ìŠ¬ë¡¯ê³¼, ë ˆì´ì§€ë¡œë”© ì „ëµ ì„¸ë¶„í™”. 


| page_name | slot_id | deviceCategoryë³„<br>ê´‘ê³  ìŠ¬ë¡¯ ì‚¬ìš©ì—¬ë¶€ | Desktop<br>Loading Type | Mobile/Tablet<br>Loading Type | load_type (Key Value) |
| :--- | :--- | :--- | :--- | :--- | :--- |
| View GPT | TC_billboard_X | desktop only | eager | N/A | `eager` |
| View GPT | MR_side_rail_X | desktop only | eager | N/A | `eager` |
| View GPT | BC_byline_rectangle | All | lazy | lazy | `lazy` |
| View GPT | BC_billboard_rectangle | All | lazy | lazy | `lazy` |
| View GPT | BC_native_list_1 | All | eager | lazy | `.setTargeting('load_type', deviceCategory === 'desktop' ? 'eager' : 'lazy')` |
| View GPT | BC_native_list_2 | All | eager | lazy | `.setTargeting('load_type', deviceCategory === 'desktop' ? 'eager' : 'lazy')` |
| View GPT | MC_article_rectangle_1 | All | lazy | lazy | `lazy` |
| View GPT | MC_article_rectangle_2 | All | lazy | lazy | `lazy` |
| View GPT | MC_article_rectangle_3 | All | lazy | lazy | `lazy` |
| View GPT | MC_article_rectangle_4 | All | lazy | lazy | `lazy` |
| View GPT | MC_article_rectangle_5 | All | lazy | lazy | `lazy` |
| View GPT | MC_article_rectangle_6 | All | lazy | lazy | `lazy` |
| View GPT | MC_article_rectangle_7 | All | lazy | lazy | `lazy` |
| View GPT | MC_article_rectangle_8 | All | lazy | lazy | `lazy` |
| HOME GPT | TC_billboard_leaderboard | All | eager | eager | `eager` |
| HOME GPT | MC_billboard_rectangle | All | lazy | lazy | `lazy` |
| HOME GPT | MR_halfpage_rectangle | All | lazy | lazy | `lazy` |
| Setion GPT | TC_billboard_leaderboard | All | eager | eager | `eager` |
| Setion GPT | MR_halfpage_rectangle | All | eager | lazy | `.setTargeting('load_type', deviceCategory === 'desktop' ? 'eager' : 'lazy')` |
| List GPT | TC_billboard_leaderboard | All | eager | eager | `eager` |
| List GPT | MR_halfpage_rectangle | All | eager | lazy | `.setTargeting('load_type', deviceCategory === 'desktop' ? 'eager' : 'lazy')` |

---

## 2. í˜ì´ì§€ë³„ ìƒì„¸ ì—…ë°ì´íŠ¸ ë‚´ì—­

### 2-1. View GPT (ê¸°ì‚¬ ë³¸ë¬¸)
* **`TC_billboard_X` (ìƒë‹¨ ë¹Œë³´ë“œ)**
    * **Load Strategy:** **Eager Load** (ì¦‰ì‹œ ë…¸ì¶œ)
    *ë°ìŠ¤í¬íƒ‘ì™¸ ë¯¸ë…¸ì¶œ(ìœ ì§€)* 

* **`MR_side_rail_X` (ìš°ì¸¡ ë ˆì¼)**
    * **Load Strategy:** ê¸°ì¡´ Lazyì—ì„œ **`EAGER_AD_SLOT_IDS`**ì— ì¶”ê°€.
    * **KeyValue : load_type: 'eager'**ë¡œ ë³€ê²½
    *ë°ìŠ¤í¬íƒ‘ì™¸ ë¯¸ë…¸ì¶œ(ìœ ì§€)* 

* **`BC_native_list_1` / `BC_native_list_2` (ìš°ì¸¡ ë¦¬ìŠ¤íŠ¸ ë‚´ ë„¤ì´í‹°ë¸Œ)**
    * **Device Policy:** ê¸°ì¡´ Mobile/Tablet ì „ìš©ì—ì„œ **All Devices(Desktop í¬í•¨, ëª¨ë“  ë””ë°”ì´ìŠ¤ì—ì„œ ë‚˜ì˜¤ë„ë¡)**ë¡œ ë³€ê²½.
    * **Load Strategy:**
        * **Desktop ì—ì„œ:** Eager Load (ë¦¬ìŠ¤íŠ¸ ë…¸ì¶œ ì‹œì  ê³ ë ¤)
        * **Mobile/Tablet ì—ì„œ:** Lazy Load (ìŠ¤í¬ë¡¤ í•˜ë‹¨ ìœ„ì¹˜ ê³ ë ¤)
        * `.setTargeting('load_type', ...)` í‚¤ ê°’ì„ ë””ë°”ì´ìŠ¤ì— ë”°ë¼ `'eager'` ë˜ëŠ” `'lazy'`ë¡œ ë™ì  í• ë‹¹(ì•„ë˜ì™€ ê°™ì´).
        **.setTargeting('load_type', deviceCategory === 'desktop' ? 'eager' : 'lazy').**

### 2-2. HOME GPT (ë©”ì¸)
* **`TC_billboard_leaderboard` (ìƒë‹¨ ë¹Œë³´ë“œ)**
    * **Load Strategy:** **Eager Load** (All Devices ë…¸ì¶œ ìœ ì§€).

* **`MR_halfpage_rectangle` (ìš°ì¸¡ ë ˆì¼)**
    * **Load Strategy:** **Lazy Load** (All Devices) í˜„ì¬ìƒíƒœ ìœ ì§€.    

* **`MC_billboard_rectangle` (ì¤‘ë‹¨ ë°°ë„ˆ)**
    * **Load Strategy:** **Lazy Load** (All Devices) í˜„ì¬ìƒíƒœ ìœ ì§€.

### 2-3. Section GPT (ì„¹ì…˜ í”„ë¡ íŠ¸) & List GPT (ë¦¬ìŠ¤íŠ¸)
ë‘ í…œí”Œë¦¿ì€ ë™ì¼í•œ ë¡œì§ê³¼ ì •ì±…ì´ ì ìš©í•©ë‹ˆë‹¤.

* **`TC_billboard_leaderboard` (ìƒë‹¨ ë¹Œë³´ë“œ)**
    * **Load Strategy:** **Eager Load** (All Devices).

* **`MR_halfpage_rectangle` (ìš°ì¸¡ ë ˆì¼)**
    * **Load Strategy (Hybrid):** ë””ë°”ì´ìŠ¤ë³„ ë¡œë”© ì „ëµ ì´ì›í™”
        * **Desktopì—ì„œëŠ”:** **Eager Load** (ì´ˆê¸° í™”ë©´ ë…¸ì¶œ ê°€ëŠ¥ì„± ë†’ìŒ)
        * **Mobile/Tablet ì—ì„œ:** **Lazy Load** (ë°˜ì‘í˜•, í•˜ë‹¨ìœ¼ë¡œ ë ˆì´ì•„ì›ƒ ë³€ê²½ë¨ì— ë”°ë¥¸ ìµœì í™”)
    * **Logic Implementation:**
        * `isDesktop` íŒë³„ ë¡œì§ì„ í†µí•´ `EAGER_AD_SLOT_IDS` ë°°ì—´ì— ë™ì ìœ¼ë¡œ ì¶”ê°€.
        * `.setTargeting('load_type', ...)` í‚¤ ê°’ì„ ë””ë°”ì´ìŠ¤ì— ë”°ë¼ `'eager'` ë˜ëŠ” `'lazy'`ë¡œ ë™ì  í• ë‹¹(ì•„ë˜ì™€ ê°™ì´).
        **.setTargeting('load_type', deviceCategory === 'desktop' ? 'eager' : 'lazy').**
---

